\chapter[Two-Phase Stokes Flow FEM]
{\sc Finite Element Approximation for Two-Phase Stokes Flow}\label{ch:stokes}
We now propose a novel finite element approximation for incompressible
two-phase Stokes flow that naturally avoids spurious velocities. Our scheme uses
a fitted approach with piecewise linear parametric finite elements to describe
the moving discrete interface and employs standard velocity and pressure finite
element spaces in the bulk. This chapter is extensively based on a paper we
wrote, see \cite{stokesfitted}.

The chapter is organised as follows: in \S\ref{sec:stokes_model} we state the
mathematical model for the incompressible two-phase Stokes flow; in
\S\ref{sec:stokes_weak} we derive the weak formulation on which our finite
element approximation is going to be based; in \S\ref{sec:stokes_energy} we show
an energy bound and the volume conservation for the weak problem; in
\S\ref{sec:stokes_fem} we present our fitted finite element discretization; in
\S\ref{sec:stokes_fitted_unfitted} we outline the main differences between a
fitted and an unfitted approach; in \S\ref{sec:stokes_existence} we prove the
existence and uniqueness of the discrete approximation; in
\S\ref{sec:stokes_stability} we demonstrate that our scheme is unconditionally
stable; in \S\ref{sec:stokes_stationary_solution} show some proprieties of
stationary solutions which will be investigated in the numerical experiments; in
\S\ref{sec:stokes_semi_fem} we investigate the equidistribution property and the
volume conservation of a semidiscrete variant of the scheme; in
\S\ref{sec:stokes_algebraic_system} we describe the arising linear systems; in
\S\ref{sec:stokes_solution_method} we explain the Schur complement approach used
to solve the algebraic system and the preconditioners adopted; in
\S\ref{sec:stokes_smoothing} we discuss the mesh generation process together
with the smoothing and remeshing procedures used to preserve the mesh quality;
in \S\ref{sec:stokes_results} we finally present several numerical simulations
in 2d and 3d.

\section{Mathematical model}\label{sec:stokes_model}
We consider two-phase Stokes flow in a given domain $\Omega\subset\R^d$, where
$d=2$ or $d=3$. As already described in \S\ref{sec:free_boundary_flows},
the domain $\Omega$ contains two different immiscible, incompressible, viscous
fluids (liquid-liquid or liquid-gas) which for all $t\in[0,T]$ occupy time
dependent regions $\Omega_+(t)$ and
$\Omega_-(t):=\Omega\setminus\overline{\Omega}_+(t)$ and which are separated by
an interface $(\Gamma(t))_{t\in[0,T]}$, $\Gamma(t)\subset\Omega$. In this
thesis, we always treat interfaces formed by closed hypersurfaces, as
illustrated in Figure~\ref{fig:two_phase_sketch} for dimension $d=2$.

The interface $\Gamma(t)$ is described with the same technique used in the
approximation of mean curvature flow and surface diffusion, see
Chapter~\ref{ch:geometric_pdes}. More precisely, we use a front tracking
approach, see \S\ref{sec:front_tracking_approach}, which parametrize the
unknown interface $\Gamma(t)$ as $\vec x(\cdot,t):\Upsilon\to\R^d$ where
$\Upsilon\subset\R^d$ is a given reference manifold such that $\Gamma(t) = \vec
x(\Upsilon,t)$. We always require that the evolving hypersurface is sufficiently
smooth and without boundary. Therefore, the velocity $\V$ of $\Gamma(t)$ is
defined by the equation (\ref{eq:V}) which we report here for the benefit of
the reader
\begin{equation*}
\V(\vec z, t) := \vec x_t(\vec q, t) \quad
\forall\ \vec z = \vec x(\vec q,t) \in \Gamma(t)\,,
\end{equation*}
where $\V \,.\,\vec \nu$ is the normal velocity of the evolving hypersurface
$\Gamma(t)$ and $\vec\nu(t)$ is the unit normal on $\Gamma(t)$ pointing into
$\Omega_+(t)$.

\sloppy The fluid dynamics in the bulk domain $\Omega$ is governed by the
two-phase Stokes model (\ref{eq:momentum_bis}--b) which describes the velocity
$\vec u$ and pressure $p$ fields of the fluid. The velocity and stress tensor,
see (\ref{eq:stress_tensor}), needs to be coupled across the free surface
$\Gamma(t)$ and therefore we impose the interface conditions
(\ref{eq:interface_jump_velocity}), (\ref{eq:interface_jump_stress}) and
(\ref{eq:interface_velocity}). Let $\partial\Omega$ be
partitioned as $\partial\Omega=\partial_1\Omega \cup \partial_2\Omega$ with
${\partial_1\Omega \cap \partial_2\Omega = \emptyset}$. We impose, on
$\partial_1 \Omega$, the Dirichlet condition $\vec u = \vec g$ and, on
$\partial_2 \Omega$, the free-slip condition $\vec u \,.\,\unitn = 0$ and
$\mat\sigma\,\unitn\,.\,\unitt = 0$, $\forall \unitt \in \{\unitn\}^\perp$,
with $\unitn$ denoting the outer unit normal of $\partial \Omega$ and
$\{\unitn\}^\perp := \{ \unitt \in \R^d : \unitt \,.\,\unitn = 0\}$. Finally, to
close the system, we prescribe the initial data $\Gamma(0) = \Gamma_0$.
Therefore the total system can be rewritten as follows:
\begin{subequations}
\begin{alignat}{2}
-2 \mu\,\nabla\,.\,\mat D(\vec u)+ \nabla\,p & = \vec f
\quad &&\mbox{in } \Omega_\pm(t)\,, \label{eq:stokes_full_momentum} \\
\nabla\,.\,\vec u & = 0 \quad &&\mbox{in } \Omega_\pm(t)\,,
\label{eq:stokes_full_mass} \\
\vec u & = \vec g \quad &&\mbox{on } \partial_1\Omega\,,
\label{eq:stokes_full_dirichlet}\\
\vec u \,.\,\unitn = 0 \,,\quad \mat\sigma\,\unitn\,.\,\unitt & = 0
\quad\forall \unitt \in \{\unitn\}^\perp \quad && \mbox{on } \partial_2\Omega\,,
\label{eq:stokes_full_freeslip}\\
[\vec u]_-^+ & = \vec 0 \quad &&\mbox{on } \Gamma(t)\,,
\label{eq:stokes_full_jump_velocity} \\
[2\mu \,\mat D(\vec u)\,.\,\vec\nu - p\,\vec \nu]_-^+
& = -\gamma\,\varkappa\,\vec\nu
\quad &&\mbox{on } \Gamma(t)\,, \label{eq:stokes_full_jump_stress} \\
(\V-\vec u)\,.\,\vec \nu & = 0
\quad &&\mbox{on } \Gamma(t)\,,\label{eq:stokes_full_velocity}  \\
\Gamma(0) & = \Gamma_0 \,,\label{eq:stokes_full_initial_interface}
\end{alignat}
\end{subequations}
where $\mu(t) = \mu_+\,\charfcn{\Omega_+(t)} + \mu_-\,\charfcn{\Omega_-(t)}$,
with $\mu_\pm \in \R_{>0}$, denotes the dynamic viscosities in the two phases,
$\mat D(\vec u):=\frac12\, (\nabla\vec u+(\nabla\vec u)^T)$
is the rate-of-deformation tensor, $\vec f$ is a possible forcing term,
$\gamma>0$ is the surface tension coefficient and $\varkappa$ denotes the
mean curvature of $\Gamma(t)$. See Chapter~\ref{ch:introduction} for more
details.

\section{Weak formulation}\label{sec:stokes_weak}
In order to obtain a weak formulation, we define the function spaces, for a
given $\vec b \in [H^1_0(\Omega)]^d$,
\begin{align*}
\uspace b &:= \{\vec \phi\in[H^1_0(\Omega)]^d:\vec \phi =\vec
g\quad \mbox{on }\partial_1\Omega\}\,,\\
\pspace &:= L^2(\Omega)\,,\\
\pnormspace &:= \{\eta\in\pspace : \int_\Omega\eta\dL{d}=0 \}\,,
\end{align*}
and let, as usual, $(\cdot,\cdot)$ and $\langle \cdot, \cdot
\rangle_{\Gamma(t)}$ denote the $L^2$--inner products on $\Omega$ and
$\Gamma(t)$, respectively. In addition, we let $\vol$ and $\surfvol$ denote the
Lebesgue measure in $\R^d$ and the $(d-1)$-dimensional Hausdorff measure,
respectively.

We also need a weak form of the differential geometry identity
(\ref{eq:LBop}) which can be obtained by multiplying (\ref{eq:LBop}) with a
test function and performing integration by parts yielding to
$$
\left\langle \varkappa\,\vec\nu, \vec\eta \right\rangle_{\Gamma(t)}
+ \left\langle \nabs\,\vec \id, \nabs\,\vec \eta \right\rangle_{\Gamma(t)}
= 0  \quad \forall\ \vec\eta \in [H^1(\Gamma(t))]^d\,.
$$
Moreover, on noting (\ref{eq:stress_tensor}) and
(\ref{eq:interface_jump_stress}), we have that
\begin{align*}
\int_{\Omega_+(t)\cup\Omega_-(t)} (\nabla\,.\,\mat\sigma)\,.\, \vec \xi \dL{d}
& = - \left(\mat\sigma, \nabla\,\vec \xi\right)
- \left\langle [\mat\sigma\,\vec\nu]_-^+ , \vec \xi
  \right\rangle_{\Gamma(t)} \nonumber \\
& = \left( p , \nabla\,.\,\vec \xi\right)
-2 \left(\mu\,\mat D(\vec u) , \mat D(\vec \xi) \right)
+ \gamma \left\langle \varkappa\,\vec \nu , \vec \xi  \right\rangle_{\Gamma(t)}
\end{align*}
for all $\vec \xi \in \uspace 0$. We notice that in the first equality we used
the standard integration by part formula where, given that the stress tensor
$\mat\sigma$ is discontinuous across the interface $\Gamma(t)$, we have the
additional term $\left\langle [\mat\sigma\,\vec\nu]_-^+ , \vec \xi
\right\rangle_{\Gamma(t)}$ which arises from the weak derivative of a
discontinuous function. Hence a possible weak formulation of
(\ref{eq:stokes_full_momentum}--h) is given as follows.
\sloppy Given $\Gamma(0) = \Gamma_0$, for almost all $t\in(0,T)$ find
$\Gamma(t)$ and ${(\vec u, p, \varkappa) \in \uspace g \times \pnormspace
\times H^1(\Gamma(t))}$ such that
\begin{subequations}
\begin{align}
& 2\left(\mu\,\mat D(\vec u), \mat D(\vec \xi)\right)
- \left(p, \nabla\,.\,\vec \xi\right)
- \gamma\,\left\langle \varkappa\,\vec\nu, \vec\xi\right\rangle_{\Gamma(t)}
= \left(\vec f, \vec \xi\right)\quad \forall\ \vec\xi \in \uspace 0 \,,
\label{eq:stokes_weaka}\\
& \left(\nabla\,.\,\vec u, \varphi\right) = 0
\quad \forall\ \varphi \in \pnormspace\,, \label{eq:stokes_weakb} \\
&  \left\langle \V
- \vec u, \chi\,\vec\nu \right\rangle_{\Gamma(t)} = 0
\quad \forall\ \chi \in H^1(\Gamma(t))\,, \label{eq:stokes_weakc} \\
& \left\langle \varkappa\,\vec\nu, \vec\eta \right\rangle_{\Gamma(t)}
+ \left\langle \nabs\,\vec \id, \nabs\,\vec \eta \right\rangle_{\Gamma(t)}
= 0  \quad \forall\ \vec\eta \in [H^1(\Gamma(t))]^d\,\label{eq:stokes_weakd}
\end{align}
\end{subequations}
holds for almost all times $t \in (0,T]$. Here we have observed that if
$p \in \pspace$ is part of a solution to (\ref{eq:stokes_full_momentum}--h),
then so is $p + c$ for an arbitrary $c\in \R$.

We finally observe that an alternative weak formulation can be obtained
using directly the vector quantity $\vec\varkappa:=\varkappa\,\vec\nu$
in the identity (\ref{eq:LBop}), see in \cite{Dziuk91,Bansch01,GanesanMT07}.
Instead, consistently with Chapter~\ref{ch:geometric_pdes}, we follow the
approach introduced in \cite{triplej} for $d=2$ and in \cite{gflows3d} for
$d=3$ which treats the mean curvature as a scalar and we treat it
separately from the normal $\vec\nu$, because this approach leads to good mesh
properties and to smaller algebraic systems.

\section{Energy bound and volume conservation}\label{sec:stokes_energy}
It is straightforward to show an a priori energy bound, in the absence of
external forces, and a volume conservation property for the system
(\ref{eq:stokes_weaka}--d). For the former, we use (\ref{eq:length_variation})
and we obtain
\begin{equation}\label{eq:dtarea}
\ddt\,\surfvol(\Gamma(t)) = -
\left\langle \varkappa,\V\,.\,\vec\nu\right\rangle_{\Gamma(t)}.
\end{equation}
Hence, in the case $\vec g=\vec 0$, on choosing $\vec\xi = \vec u$ in
(\ref{eq:stokes_weaka}), and noting
(\ref{eq:stokes_weakb},c), we obtain that
\begin{align}
\gamma\, \ddt\,\surfvol(\Gamma(t)) = -
\gamma\,\left\langle \varkappa\,\vec\nu, \vec u\right\rangle_{\Gamma(t)}
=  - 2\left(\mu\,\mat D(\vec u), \mat D(\vec u)\right) +
\left(\vec f, \vec u\right) \,,
\label{eq:ap1}
\end{align}
and so in the absence of outer forces, the interfacial energy is monotonically
decreasing.

In order to show the volume conservation property, we use
(\ref{eq:volume_variation}) to have that
\begin{align}
\ddt \vol(\Omega_-(t)) & = \left\langle \V, \vec\nu
\right\rangle_{\Gamma(t)}\,.
\end{align}
Hence it follows immediately from the incompressibility condition
(\ref{eq:stokes_weakb}) and (\ref{eq:stokes_weakc}), using the divergence
theorem, that
\begin{align}
\ddt \vol(\Omega_-(t)) & = \left\langle \vec u , \vec\nu
\right\rangle_{\Gamma(t)}
 = \int_{\Omega_-(t)} \nabla\,.\,\vec u \dL{d} =0\,. \label{eq:conserved}
\end{align}
It will be our aim to introduce a fitted finite element approximation for
two-phase Stokes flow that satisfies discrete analogous of
(\ref{eq:ap1}) and (\ref{eq:conserved}).

\section{Finite element approximation}\label{sec:stokes_fem}
We consider the partitioning  $0= t_0 < t_1 < \ldots < t_{M-1} < t_M = T$ of
$[0,T]$ into possibly variable time steps $\tau_m := t_{m+1}-t_m$, $m=0
,\ldots, M-1$. Moreover, let ${\cal T}^m$, $\forall m\ge 0$, be a regular
partitioning of the domain $\Omega$ into disjoint open simplices
$\sigmaO^m_j$, $j = 1 ,\ldots, J^m_\Omega$. From now on, the domain $\Omega$
which we consider is the polyhedral domain defined by the triangulation ${\cal
T}^m$. On ${\cal T}^m$ we define the finite element spaces
\begin{equation*}
S^m_k := \{\chi \in C(\overline{\Omega}) : \chi\!\mid_{\sigmaO^m}
\in \mathcal{P}_k(\sigmaO^m) \ \forall\ \sigmaO^m \in {\cal T}^m\}\,,
\quad k \in \mathbb{N}\,,
\end{equation*}
where $\mathcal{P}_k(\sigmaO^m)$ denotes the space of polynomials of degree $k$
on $\sigmaO^m$. Moreover, $S^m_0$ is the space of piecewise constant functions
on ${\cal T}^m$. For later use, we also define $\vec I^m_k$ to be the standard
interpolation operator onto $[S^m_k]^d$.

Let $\uspacedisc{g}{m}\subset\uspacesimple(\vec I_k^m\vec g)$ and
$\pspace^m\subset\pspace$ be the finite element spaces we use for the
approximation of velocity and pressure, and let $\pnormspace^m:= \pspace^m \cap
\pnormspace$. The spaces $(\uspacedisc{0}{m},\pspace^m)$ satisfy the LBB
inf-sup condition if there exists a constant $C_0 \in \R_{>0}$, independent of
$\mathcal{T}^m$, such that
\begin{equation} \label{eq:LBB}
\inf_{\varphi \in \pnormspace^m} \sup_{\vec \xi \in \uspacedisc{0}{m}}
\frac{( \varphi, \nabla \,.\,\vec \xi)} {\|\varphi\|_0\,\|\vec \xi\|_1}
\geq C_0 > 0\,,
\end{equation}
see \cite[p.~114]{GiraultR86}. Here $\|\cdot\|_0 := (\cdot,\cdot)^\frac12$ and
$\|\cdot\|_1 := \|\cdot\|_0 + \|\nabla\,\cdot\|_0$ denote the $L^2$--norm and
the $H^1$--norm on $\Omega$, respectively. Throughout this thesis, if not
otherwise stated, we will assume that $\charfcn{\Omega^m_-}\in\pspace^m$. Then,
for $d=2$, possible pairs $(\uspacedisc{0}{m},\pspace^m)$ that satisfy
(\ref{eq:LBB}) are P2--P0 and P2--(P1+P0), i.e. we set
$\uspacedisc{0}{m}=[S^m_2]^d\cap\uspace{0}$ and either $\pspace^m = S^m_0$ or
$S^m_1+S^m_0$. We note that the choice P2--(P1+P0) requires the weak constraint
that all simplices have a vertex in $\Omega$, see \cite{BoffiCGG12}. For $d=3$,
pairs of spaces that satisfy $\charfcn{\Omega^m_-}\in\pspace^m$ and
(\ref{eq:LBB}) are the P3--(P2+P0) element, see \cite{BoffiCGG12}, or stabilized
spaces such as P1$^{\mbox{face bubble}}$--P0, see
\cite[Remark~8.7.1]{BoffiBF13}, which is also called the SMALL element. With a
view towards our numerical simulations, we also introduce the pairs P2--\pdg
where the space \pdg is a space of polynomial order 1 defined in the two
subdomains $\Omega_-^m$ and $\Omega_+^m$. This space is equivalent to a P1 space
which is continuous everywhere except across the interface $\Gamma^m$. With this
choice of space, the discrete scheme fall in the category of XFEM, extended
FEM, since the pressure space is enriched adding additional degree of freedoms
for the nodes on the interface in order to capture the discontinuity of the
pressure.

In this thesis we consider a fitted finite element approximation for the
evolution of the interface $\Gamma(t)$. Let $\Gamma^m\subset\R^d$ be a
$(d-1)$-dimensional polyhedral surface approximating the closed surface
$\Gamma(t_m)$, $m=0 ,\ldots, M$. Let $\Omega^m_+$ denote the exterior of
$\Gamma^m$ and let $\Omega^m_-$ be the interior of $\Gamma^m$, where we assume
that $\Gamma^m$ has no self-intersections. Then
$\Omega = \Omega_-^m \cup \Gamma^m \cup \Omega_+^m$, and the fitted nature of
our method implies that
\begin{equation} \label{eq:fittedO}
\overline{\Omega^m_+} = \bigcup_{o \in \mathcal{T}^m_+} \overline{o}
\quad\text{and}\quad
\overline{\Omega^m_-} = \bigcup_{o \in \mathcal{T}^m_-} \overline{o} \,,
\end{equation}
where $\mathcal{T}^m = \mathcal{T}^m_+ \cup \mathcal{T}^m_-$ and
$\mathcal{T}^m_+ \cap \mathcal{T}^m_- = \emptyset$.
Let $\vec \nu^m$ denote the piecewise constant unit normal to $\Gamma^m$
such that $\vec\nu^m$ points into $\Omega^m_+$.

In order to define the parametric finite element spaces on $\Gamma^m$, we
proceed analogously to the mean curvature flow and surface diffusion problems,
see \S\ref{sec:geometric_pdes_fem}. Therefore we assume that
$\Gamma^m=\bigcup_{j=1}^{J_\Gamma} \overline{\sigma^m_j}$, where
$\{\sigma^m_j\}_{j=1}^{J_\Gamma}$ is a family of mutually disjoint open
$(d-1)$-simplices with vertices $\{\vec q^m_k\}_{k=1}^{K_\Gamma}$. Then
we define $\Vh := \{\vec\chi \in [C(\Gamma^m)]^d:\vec\chi\!\mid_{\sigma^m_j}
\in \mathcal{P}_1(\sigma^m_j), j=1,\ldots, J_\Gamma\} =: [\Wh]^d$, where $\Wh
\subset H^1(\Gamma^m)$ is the space of scalar continuous piecewise linear
functions on $\Gamma^m$, with $\{\chi^m_k\}_{k=1}^{K_\Gamma}$ denoting the
standard basis of $\Wh$. As usual, we parametrize the new surface
$\Gamma^{m+1}$ over $\Gamma^m$ using a parametrization $\vec X^{m+1} \in \Vh$,
so that $\Gamma^{m+1} = \vec X^{m+1}(\Gamma^m)$. Finally, let
$\langle\cdot,\cdot\rangle_{\Gamma^m}^h$ be the mass lumped inner product on
$\Gamma^m$, see (\ref{eq:masslump}), and let
$\langle\cdot,\cdot\rangle_{\Gamma^m}$ denote the standard $L^2$--inner product
on $\Gamma^m$.

\sloppy Then our finite element approximation, which is based on the variational
formulation (\ref{eq:stokes_weaka}--d), assumes the following formulation. Let
$\Gamma^0$ be an approximation to the initial interface $\Gamma(0)$. For
$m=0,\ldots, M-1$, find ${(\vec U^{m+1}, P^{m+1}, \vec X^{m+1}, \kappa^{m+1})
\in \uspacedisc{g}{m}\times \pnormspace^m \times \Vh \times \Wh}$ such that
\begin{subequations}
\begin{align}
& 2\left(\mu^m\,\mat D(\vec U^{m+1}), \mat D(\vec \xi) \right)
- \left(P^{m+1}, \nabla\,.\,\vec \xi\right) \nonumber \\
& - \gamma\,\left\langle \kappa^{m+1}\,\vec\nu^m,\vec\xi\right\rangle_{\Gamma^m}
= \left(\vec f^{m+1},\vec \xi\right) \quad \forall\ \vec\xi \in
\uspacedisc{0}{m}\,, \label{eq:HGa}\\
& \left(\nabla\,.\,\vec U^{m+1}, \varphi\right)  = 0
\quad \forall\ \varphi \in \pnormspace^m\,,\label{eq:HGb} \\
&  \left\langle \frac{\vec X^{m+1} - \vec\id}{\tau_m} ,\chi\,\vec\nu^m
\right\rangle_{\Gamma^m}^h - \left\langle \vec U^{m+1}, \chi\,\vec\nu^m
\right\rangle_{\Gamma^m}  = 0 \quad \forall\ \chi \in \Wh\,, \label{eq:HGc} \\
& \left\langle \kappa^{m+1}\,\vec\nu^m, \vec\eta \right\rangle_{\Gamma^m}^h
+ \left\langle \nabs\,\vec X^{m+1}, \nabs\,\vec \eta \right\rangle_{\Gamma^m} =
0 \quad \forall\ \vec\eta \in \Vh \label{eq:HGd}
\end{align}
\end{subequations}
and set $\Gamma^{m+1} = \vec X^{m+1}(\Gamma^m)$. Here we have defined
$\vec f^{m+1}(\cdot) := \vec I^m_2\,\vec f(\cdot,t_{m+1})$ and
\begin{equation}
\mu^m =\mu_+\,\charfcn{\Omega^m_+} + \mu_-\,\charfcn{\Omega^m_-}\in S^m_0\,.
\end{equation}
We observe that (\ref{eq:HGa}--d) is a linear scheme in that it leads to a
coupled linear system of equations for the unknowns
$(\vec U^{m+1}, P^{m+1}, \vec X^{m+1}, \kappa^{m+1})$ at each time level.
We also note that the scheme (\ref{eq:HGa}--d), in the context of an
unfitted finite element approximation, has been considered in \cite{spurious}.
In particular, most of the theoretical results presented in the following
are a direct consequence of the results in \cite{spurious}.

\section{Fitted and unfitted approach}\label{sec:stokes_fitted_unfitted}
The key difference between \cite{spurious} and our approach is that the former
uses an unfitted approach while the latter adopts a fitted one. In
Figure~\ref{fig:fitted_unfitted}, from \cite[Fig.~1]{spurious}, is shown an
example of fitted and unfitted interface meshes for a circular interface.
\begin{figure}[htbp]
\centering
\subfloat[Fitted mesh]{
\includegraphics[width=.45\textwidth]
{figures/stokes/fitted_mesh.ps}}
\subfloat[Unfitted mesh]{
\includegraphics[width=.45\textwidth]
{figures/stokes/unfitted_mesh.ps}}
\caption[Fitted and unfitted meshes]
{Fitted and unfitted meshes for a circular interface.}
\label{fig:fitted_unfitted}
\end{figure}
In the fitted approach, the interface mesh is made up of edges, in 2d, or faces,
in 3d, of elements belonging to the bulk mesh. This means that there is a strong
coupling between the bulk mesh and interface mesh. This is a very intuitive
approach to treat the problem. Discontinuity jumps in the material properties
and in the pressure are captured naturally. In particular, we do not need to
employ an XFEM-type extension of standard bulk pressure spaces. Moreover, there
is no need to transport quantities from the interface to the bulk, or vice
versa. On the other hand, it is not possible to locally refine the bulk mesh
close to the interface without modifying the number of elements of the
interface. Also, every interface deformation corresponds to a bulk deformation,
which means that smoothing and remeshing techniques need to be employed in
order to preserve the bulk mesh quality.

Instead, in the unfitted approach, the interface mesh is completely independent
from the bulk mesh. In particular, there exist bulk elements which are cut by
the interface elements. For this reason there is no need to remesh or deform
the bulk mesh in order to preserve the correspondence with the interface.
Moreover, standard strategies for refinement and coarsening can be employed for
the bulk mesh. Since the bulk mesh is immutable, its quality is preserved
without the need of smoothing techniques. The downside of this approach is that
the quantities computed on the bulk mesh, such as velocity and pressure, need
to be interpolated in order to have their values on the interface. This also
requires to find the intersections between the interface mesh and the bulk mesh
at every time step. Finally, it is necessary to use some XFEM-type extension in
order to capture discontinuity of quantities of interest across the interface.

\section{Existence and uniqueness of a discrete solution}
\label{sec:stokes_existence}
\begin{theorem} \label{thm:ex}
Let $m \in \{0,\ldots,M-1\}$ and let $(\uspacedisc{0}{m},\pspace^m)$ satisfy
the LBB condition (\ref{eq:LBB}). Then there exists a unique solution
$(\vec U^{m+1}, P^{m+1}, \vec X^{m+1}, \kappa^{m+1})
\in \uspacedisc{g}{m}\times \pnormspace^m \times \Vh \times \Wh$ to
(\ref{eq:HGa}--d).
\end{theorem}
\begin{proof}
\sloppy As the system (\ref{eq:HGa}--d) is linear, existence follows from
uniqueness. In order to establish the latter, we consider the system: Find
${(\vec U, P, \vec X, \kappa) \in \uspacedisc{0}{m}\times\pnormspace^m \times
\Vh \times \Wh}$ such that
\begin{subequations}
\begin{align}
& 2\left(\mu^m\,\mat D(\vec U), \mat D(\vec \xi) \right)
- \left(P, \nabla\,.\,\vec \xi\right) - \gamma\,\left\langle \kappa\,\vec\nu^m,
\vec\xi\right\rangle_{\Gamma^m} = 0 \quad \forall\ \vec\xi \in
\uspacedisc{0}{m} \,,
\label{eq:proofa}\\
& \left(\nabla\,.\,\vec U, \varphi\right)  = 0 \quad
\forall\ \varphi \in \pnormspace^m\,, \label{eq:proofb} \\
& \left\langle \vec X, \chi\,\vec\nu^m \right\rangle_{\Gamma^m}^h -
\tau_m \left\langle \vec U, \chi\,\vec\nu^m \right\rangle_{\Gamma^m} = 0
\quad\forall\ \chi \in \Wh\,,\label{eq:proofc} \\
& \left\langle \kappa\,\vec\nu^m, \vec\eta \right\rangle_{\Gamma^m}^h
+ \left\langle \nabs\,\vec X, \nabs\,\vec \eta \right\rangle_{\Gamma^m}
= 0  \quad\forall\ \vec\eta \in \Vh\,. \label{eq:proofd}
\end{align}
\end{subequations}
Choosing $\vec\xi=\vec U$ in (\ref{eq:proofa}), $\varphi =  P$ in
(\ref{eq:proofb}), $\chi = \gamma\,\kappa$ in (\ref{eq:proofc}) and
$\vec\eta=\gamma\,\vec X$ in (\ref{eq:proofd}) yields that
\begin{equation}
2\,\tau_m\left(\mu^m\,\mat D(\vec U), \mat D(\vec U) \right)
+ \gamma\,\left\langle \nabs\,\vec X, \nabs\,\vec X \right\rangle_{\Gamma^m}
=0\,, \label{eq:proof2}
\end{equation}
which implies that $\mat D(\vec U) = \mat 0$. We know that the kernel of
$\mat D$ is the space of rigid motions
\begin{equation}
RM=\{\vec \alpha + \mathcal A \vec z:\vec \alpha \in \R^d\,,
\mathcal A \mbox{ antisymmetric matrix in }\R^{d\times d} \}\,,
\end{equation}
see \cite{Mardal2006}. Given that $\vec U \in RM$, in particular we have that
$\vec U$ is linear in $\vec z$. Therefore $\vec U$ is constant and, in order
to fulfil the boundary conditions, it needs to be $\vec U = \vec 0$. In
addition, it holds that $\vec X$ is equal to a constant on $\Gamma^m$, which
satisfies, on recalling (\ref{eq:proofc}) and $\vec U = \vec 0$, that
\begin{equation} \label{eq:Xconst}
\left\langle \vec X, \chi\,\vec\nu^m \right\rangle_{\Gamma^m}^h = 0
\quad\forall\ \chi \in \Wh\,.
\end{equation}
It was shown in \cite[Proof of Theorem~2.1]{gflows3d} that if $\Gamma^m$
has no self-intersections, then (\ref{eq:Xconst}) immediately yields that $\vec
X = \vec 0$. As $\Gamma^m = \partial\Omega^m_-$ is the boundary of an open
domain, we always assume that it does not self-intersect, and
hence we obtain that $\vec X = \vec 0$. This means that (\ref{eq:proofd})
reduces to
\begin{equation} \label{eq:kappaproof}
\left\langle \kappa\,\vec\nu^m, \vec\eta \right\rangle_{\Gamma^m}^h = 0
\quad\forall\ \vec\eta \in \Vh\,.
\end{equation}
Let $\vec\omega^m \in \Vh$ be the mass-lumped $L^2$--projection of $\vec\nu^m$
onto $\Vh$, i.e. $\left\langle \vec\omega^m, \vec\varphi
\right\rangle_{\Gamma^m}^h = \left\langle \vec\nu^m,
\vec\varphi \right\rangle_{\Gamma^m}^h = \left\langle \vec\nu^m,
\vec\varphi \right\rangle_{\Gamma^m}$ for all $\vec\varphi\in\Vh$. It is easy
to see that $\vec\omega^m (\vec q^m_k) \not= \vec 0$ for
all $k=1,\ldots,K_\Gamma$, because $\Gamma^m$ does not self-intersect.
Then it follows from choosing $\vec\eta = \vec\omega^m$ in (\ref{eq:kappaproof})
that
\begin{align*}
0 = \left\langle \kappa\,\vec\nu^m, \vec\omega^m \right\rangle_{\Gamma^m}^h
= \left\langle \vec\nu^m, \vec\pi^m[\kappa\,\vec\omega^m]
\right\rangle_{\Gamma^m}
= \left\langle \vec\omega^m,
\vec\pi^m[\kappa\,\vec\omega^m] \right\rangle_{\Gamma^m}^h
= \left\langle \kappa, |\vec\omega^m|^2 \right\rangle_{\Gamma^m}^h ,
\end{align*}
and so $\kappa = 0 \in \Wh$. Finally, it follows from (\ref{eq:proofa}) with
$\vec U = \vec 0$ and $\kappa = 0$, on recalling (\ref{eq:LBB}), that $P = 0$.
Hence there exists a unique solution $(\vec U^{m+1}, P^{m+1}, \vec X^{m+1},$
$\kappa^{m+1}) \in \uspacedisc{g}{m}\times \pnormspace^m \times \Vh \times \Wh$
to (\ref{eq:HGa}--d).
\end{proof}

We note that if $(\uspacedisc{0}{m},\pspace^m)$ does not satisfy the LBB
condition (\ref{eq:LBB}), then existence and uniqueness of the solution
$(\vec U^{m+1},\vec X^{m+1},\kappa^{m+1})$ to a reduced system, where the
pressure $P^{m+1}$ is eliminated, can be shown. More precisely, let
\begin{equation}
\uspacesimple^m_0(\vec g) :=
\{ \vec U \in \uspacedisc{g}{m} : (\nabla\,.\,\vec U, \varphi) = 0
\quad \forall \varphi \in \pspace^m \}\,.
\end{equation}
Then any solution $(\vec U^{m+1}, P^{m+1}, \vec X^{m+1}, \kappa^{m+1})
\in \uspacedisc{g}{m}\times \pnormspace^m \times \Vh \times \Wh$
to (\ref{eq:HGa}--d) is such that $(\vec U^{m+1}, \vec X^{m+1}, \kappa^{m+1})
\in \uspacesimple^m_0(\vec g)\times \Vh \times \Wh$ satisfies
\begin{subequations}
\begin{align}
& 2\left(\mu^m\,\mat D(\vec U^{m+1}), \mat D(\vec \xi) \right)
- \gamma\,\left\langle \kappa^{m+1}\,\vec\nu^m,\vec\xi\right\rangle_{\Gamma^m}
= \left(\vec f^{m+1},\vec \xi\right) \quad \forall\ \vec\xi \in
\uspacesimple^m_0(\vec 0)\,, \label{eq:reda}\\
&  \left\langle \frac{\vec X^{m+1} - \vec\id}{\tau_m} ,\chi\,\vec\nu^m
\right\rangle_{\Gamma^m}^h - \left\langle \vec U^{m+1}, \chi\,\vec\nu^m
\right\rangle_{\Gamma^m}  = 0 \quad \forall\ \chi \in \Wh\,,
\label{eq:redb} \\
& \left\langle \kappa^{m+1}\,\vec\nu^m, \vec\eta \right\rangle_{\Gamma^m}^h
+ \left\langle \nabs\,\vec X^{m+1}, \nabs\,\vec \eta \right\rangle_{\Gamma^m} =
0 \quad \forall\ \vec\eta \in \Vh \label{eq:redc}
\end{align}
\end{subequations}

\begin{theorem} \label{thm:stabreduced}
Let $m \in \{0,\ldots,M-1\}$. Then there exists a unique solution
$(\vec U^{m+1}, \vec X^{m+1}, \kappa^{m+1}) \in \uspacesimple^m_0(\vec g)
\times \Vh \times \Wh$ to (\ref{eq:reda}--c).
\end{theorem}
\begin{proof}
As $\uspacesimple^m_0(\vec g)$ is a subspace of $\uspacedisc{g}{m}$, existence
to the linear system (\ref{eq:reda}--c) follows from uniqueness, which is easy
to show. In fact, similarly to the proof of Theorem~\ref{thm:ex} we obtain
(\ref{eq:proof2}) and hence the desired uniqueness result.
\end{proof}

\section{Stability}\label{sec:stokes_stability}
We now demonstrate that the scheme (\ref{eq:HGa}--d) satisfies an energy
estimate, which corresponds to the bound (\ref{eq:ap1}) in the continuous case.
In particular, we obtain an unconditional stability result for our scheme.

\begin{theorem} \label{thm:stabstab}
\sloppy Let $\vec g=\vec 0$. Moreover let $m \in \{0,\ldots,M-1\}$ and let
${(\vec U^{m+1},P^{m+1},\vec X^{m+1}, \kappa^{m+1}) \in \uspacedisc{0}{m}\times
\pnormspace^m \times \Vh \times \Wh}$ be a solution to (\ref{eq:HGa}--d). Then
\begin{equation}\label{eq:stab}
\gamma\, \surfvol(\Gamma^{m+1})
+ 2\,\tau_m\left(\mu^m\,\mat D(\vec U^{m+1}), \mat D(\vec U^{m+1}) \right) \leq
\gamma\,\surfvol(\Gamma^m) + \tau_m\left( \vec f^{m+1}, \vec U^{m+1}
\right).
\end{equation}
In addition, let $\{t_k\}_{k=0}^M$ be an arbitrary partitioning of $[0,T]$.

Then it holds that
\begin{equation}\label{eq:stabstab}
\gamma\,\surfvol(\Gamma^{m+1})
+ 2 \sum_{k=0}^m  \tau_k\left(\mu^k\,\mat D(\vec U^{k+1}), \mat D(\vec U^{k+1})
\right)\leq \gamma\,\surfvol(\Gamma^0) + \sum_{k=0}^m \tau_k\left(\vec
f^{k+1}, \vec U^{k+1} \right)
\end{equation}
for $m=0,\ldots, M-1$.
\end{theorem}
\begin{proof}
Choosing $\vec\xi = \vec U^{m+1} \in \uspacedisc{0}{m}$ in (\ref{eq:HGa}),
$\varphi = P^{m+1} \in \pnormspace^m$ in (\ref{eq:HGb}),
$\chi = \gamma\,\kappa^{m+1}$ in (\ref{eq:HGc}) and
$\vec\eta=\gamma\,({\vec X^{m+1}-\vec\id\!\mid_{\Gamma^m}})$ in (\ref{eq:HGd})
yields that
\begin{align*}
& 2\,\tau_m\left(\mu^m\,\mat D(\vec U^{m+1}), \mat D(\vec U^{m+1}) \right)
+ \gamma\,\left\langle \nabs\,\vec X^{m+1}, \nabs\,(\vec X^{m+1} - \vec X^m)
\right\rangle_{\Gamma^m} \nonumber \\
& \qquad = \tau_m\left(\vec f^{m+1}, \vec U^{m+1} \right)\,.
\end{align*}
Hence (\ref{eq:stab}) follows immediately, where we have used the result that
$\left\langle \nabs\,\vec X^{m+1}, \nabs\,(\vec X^{m+1} - \vec X^m)
\right\rangle_{\Gamma^m} \geq \surfvol(\Gamma^{m+1}) - \surfvol(\Gamma^m)$,
see e.g.\ \cite[Proof of Theorem~2.3]{triplej} and
\cite[Proof of Theorem~2.2]{gflows3d} for the proofs for $d=2$ and $d=3$,
respectively. The desired result (\ref{eq:stabstab}) immediately follows from
(\ref{eq:stab}).
\end{proof}

\section{Discrete stationary solutions}\label{sec:stokes_stationary_solution}
If the solution $(\vec U^{m+1},P^{m+1},\vec X^{m+1}, \kappa^{m+1})$ to
(\ref{eq:HGa}--d) is such that the interface has not moved,
$\Gamma^{m+1} = \Gamma^m$, then it holds that
\begin{equation}\label{eq:conformal}
\exists\ \zeta \in \Wh \ : \quad \left\langle \zeta\,\vec\nu^m, \vec\eta
\right\rangle_{\Gamma^m}^h + \left\langle \nabs\,\vec \id, \nabs\,\vec \eta
\right\rangle_{\Gamma^m} = 0 \quad \forall\ \vec\eta \in \Vh \,.
\end{equation}
We recall from \cite[Remark~2.4]{triplej} that (\ref{eq:conformal}) in the
case $d=2$ implies that $\Gamma^m$ is equidistributed, with the possible
exception of
elements $\sigma^m_j$ that are locally parallel to each other; see also
\cite[Theorem~2.2]{fdfi}.
Moreover, we recall from \cite[\S4.1]{gflows3d}
that surfaces $\Gamma^m \subset \R^3$
that satisfy (\ref{eq:conformal}) are called conformal polyhedral surfaces.

Next we consider discrete stationary states when no outer forces act, i.e. when
$\vec f = \vec 0$. Here, independently of the choice of $\mu_\pm$, no spurious
velocities appear for discrete stationary solutions. Indeed,
Theorem~\ref{thm:stabstab} has an immediate consequence.
\begin{theorem}\label{thm:stat1}
Let $\vec g=\vec 0$. Let $(\vec U^{m+1},P^{m+1},\vec X^{m+1}, \kappa^{m+1})
\in \uspacedisc{0}{m}\times
\pnormspace^m \times \Vh \times \Wh$ be a solution to  (\ref{eq:HGa}--d) with
$\vec f^{m+1} = \vec 0$. If $\vec X^{m+1} = \vec X^m$, then $\vec U^{m+1} = \vec
0$.
\end{theorem}
\begin{proof}
The solution $(\vec U^{m+1}, \vec X^{m+1})$ fulfils (\ref{eq:stab}) with
$\Gamma^{m+1}$ replaced by $\Gamma^m$ and  $\vec f^{m+1} = \vec 0$. Hence we
obtain $(\mu^m\,\mat D (\vec U^{m+1}), \mat D(\vec U^{m+1})) = 0$, and so, as
shown in Theorem~\ref{thm:ex}, it implies $\vec U^{m+1} = \vec 0$.
\end{proof}

Finally, it holds that polyhedral surfaces with constant discrete mean
curvature and zero velocity are stationary solutions
\begin{theorem} \label{thm:stat2}
Let $\vec g=\vec 0$. Let $(\uspacedisc{0}{m},\pspace^m)$ satisfy the LBB
condition (\ref{eq:LBB}) and let
$\charfcn{\Omega^m_-}\in\pspace^m$. Let $\vec f^{m+1} = \vec 0$. Moreover, let
$\Gamma^m$ be a polyhedral surface with constant discrete mean curvature,
i.e. there exists a constant $\overline{\kappa}\in\R$ such that
\begin{equation}\label{eq:constcurv}
\overline{\kappa} \left\langle\vec\nu^m,\vec\eta\right\rangle_{\Gamma^m}
+ \left\langle \nabs\, \vec\id,\nabs\ \vec\eta\right\rangle_{\Gamma^m}=0\quad
\forall \,\vec\eta\in\Vh\,.
\end{equation}
Then $\Gamma^m$ satisfies (\ref{eq:conformal}) and
\begin{equation} \label{eq:solsol}
(\vec U^{m+1}, P^{m+1}, \vec X^{m+1}, \kappa^{m+1}) =
(\vec 0, -\gamma\,\overline\kappa\left[
\charfcn{\Omega_-^m} - \frac{\vol(\Omega_-^m)}{\vol(\Omega)}
\right], \vec\id\!\mid_{\Gamma^m}, \overline{\kappa})
\end{equation}
is the unique solution to (\ref{eq:HGa}--d).
\end{theorem}
\begin{proof}
It immediately follows from (\ref{eq:constcurv}) that (\ref{eq:conformal})
holds. We now show that the solution stated in (\ref{eq:solsol}) solves
(\ref{eq:HGa}--d). Since $\charfcn{\Omega_-^m} \in \pspace^m$, we have
that $P^{m+1} \in \pnormspace^m$, and so (\ref{eq:solsol}) is admissible.
Clearly, the three equations (\ref{eq:HGb}), (\ref{eq:HGc}) and (\ref{eq:HGd})
hold trivially. In order to show that (\ref{eq:HGa}) holds, we observe that the
divergence theorem implies that
\begin{equation*}
- \gamma \left\langle \kappa^{m+1}\,\vec\nu^m, \vec\xi
\right\rangle_{\Gamma^m}
= - \gamma\,\overline\kappa \left\langle \vec\nu^m, \vec\xi
\right\rangle_{\Gamma^m}
= - \gamma\,\overline\kappa \left(\nabla\,.\,\vec\xi,
\charfcn{\Omega_-^m}\right)
= \left(\nabla\,.\,\vec\xi, P^{m+1} \right)
\end{equation*}
for all $\vec\xi \in \uspacedisc{0}{m}$, where we have observed that $P^{m+1}$
differs from $- \gamma\,\overline\kappa\,\charfcn{\Omega_-^m}$ only by a
constant. Hence (\ref{eq:HGa}) also holds, and so (\ref{eq:solsol}) is the
unique solution to (\ref{eq:HGa}--d)
\end{proof}

A stationary solution to the continuous problem with $\vec f = \vec 0$ is a
circle, $d=2$, or a sphere, $d=3$, with zero velocity and a piecewise constant
pressure with a discontinuity across the interface, see (\ref{eq:radialr}--b).

For $d=2$, one can choose $\Gamma^m$ with equidistributed points on a circle as
an approximation of this circle, i.e. a closed regular polygon.
Such a $\Gamma^m$ has constant discrete curvature, i.e. there exists a
$\overline{\kappa} \in \R$ such that (\ref{eq:constcurv}) is satisfied.
Hence Theorem~\ref{thm:stat2} yields that in this situation $(\vec
U^{m+1}, \vec X^{m+1}, \kappa^{m+1}) = (\vec 0, \vec X^m,\overline{\kappa})$ is
the unique solution to the reduced system with $\vec f^{m+1} =\vec 0$. See
\S\ref{sec:stokes_2d_convergence_results} for details.

For $d=3$, we observe in practice that conformal approximations of the sphere,
i.e. spherical $\Gamma^m$ satisfying (\ref{eq:conformal}), also satisfy
(\ref{eq:constcurv}). See \S\ref{sec:stokes_3d_convergence_results} for details.

\section{Semidiscrete scheme}\label{sec:stokes_semi_fem}
We briefly investigate a semidiscrete variant of the scheme (\ref{eq:HGa}--d)
in order to highlight two additional important properties of the scheme: a
good tangential distribution of mesh points, and good volume conservation. For
simplicity, we assume $\vec g=\vec 0$ throughout this section.

Let $(\Gamma^h(t))_{t\in[0,T]}$ be a family of polyhedral surfaces, with
outer normal $\vec\nu^h(t)$. We also define the piecewise linear finite element
spaces $\Wht$ and $\Vht$, with $\{\chi^h_k(\cdot,t)\}_{k=1}^{K_\Gamma}$
denoting the standard basis of the former. Hence $\chi^h_k(\vec q^h_l(t),t) =
\delta_{kl}$ for all $k,l \in \{1,\ldots,K_\Gamma\}$ and $t \in [0,T]$, where
$\{\vec q^h_k(t)\}_{k=1}^{K_\Gamma}$ are the vertices of $\Gamma^h(t)$.
Similarly to (\ref{eq:V}), we can then define the discrete velocity
\begin{equation*}
\V^h(\vec z, t):=
\sum_{k=1}^{K_\Gamma}\left[\ddt\,\vec q^h_k(t)\right] \chi^h_k(\vec z, t)
\in \Vht\,,
\end{equation*}
see e.g. \cite[(3.3)]{tpfs}. For $t\in [0,T]$, let $\mathcal{T}^h(t)$ be a
regular partitioning of $\Omega$ into disjoint open simplices and define the
finite element spaces $S^h_k(t)$, $\uspacesimple^h(t)$ and $\pspace^h(t)$
similarly to $S^m_k$, $\uspacedisc{0}{m}$ and $\pspace^m$, with the
corresponding interpolation operators $I^h_k$ and discrete approximations
$\mu^h(t) \in S^h_0(t)$. Here we recall that we assume
$\charfcn{\Omega^h_-(t)}\in\pspace^h(t)$. Then, given $\Gamma^h(0)$, for $t\in
(0,T]$ find $\Gamma^h(t)$ and $(\vec U^h(t), P^h(t), \V^h(t), \kappa^h(t)) \in
\uspacesimple^h(t) \times \pnormspace^h(t) \times \Vht \times \Wht$ such that
\begin{subequations}
\begin{align}
& 2\left(\mu^h\,\mat D(\vec U^h), \mat D(\vec \xi) \right)
- \left(P^h, \nabla\,.\,\vec \xi\right) - \gamma\,\left\langle
\kappa^h\,\vec\nu^h, \vec\xi\right\rangle_{\Gamma^h(t)} = \left(\vec f^h, \vec
\xi\right) \forall\ \vec\xi \in \uspacesimple^h(t) \,, \label{eq:sda}\\
& \left(\nabla\,.\,\vec U^h, \varphi\right)  = 0
\quad \forall\ \varphi \in \pnormspace^h(t)\,, \label{eq:sdb} \\
& \left\langle \V^h , \chi\,\vec\nu^h
\right\rangle_{\Gamma^h(t)}^h - \left\langle \vec U^h, \chi\,\vec\nu^h
\right\rangle_{\Gamma^h(t)} = 0 \quad \forall\ \chi \in \Wht\,, \label{eq:sdc}
\\
& \left\langle \kappa^h\,\vec\nu^h, \vec\eta \right\rangle_{\Gamma^h(t)}^h
+ \left\langle \nabs\,\vec\id, \nabs\,\vec \eta \right\rangle_{\Gamma^h(t)} = 0
\quad \forall\ \vec\eta \in \Vht\,, \label{eq:sdd}
\end{align}
\end{subequations}
where $\vec f^h := \vec I^h_2\,\vec f(t)$.

First of all we note that a solution $\Gamma^h(t)$ to (\ref{eq:sda}--d) clearly
satisfies (\ref{eq:conformal}), with $\Gamma^m$ replaced by $\Gamma^h(t)$. This
means that in 2d the polygonal curve $\Gamma^h(t)$ is equidistributed, and
asymptotically this property is inherited by our fully discrete scheme
(\ref{eq:HGa}--d); see e.g. Figure~\ref{fig:nonuniform_bubble_32_both} below.
In 3d the property (\ref{eq:conformal}) means that $\Gamma^h(t)$ is a
conformal polyhedral surface, which implies that the mesh quality is good. Once
again, we observe in practice that the fully discrete solutions to
(\ref{eq:HGa}--d) also exhibit nice meshes, without coalescence or other
mesh defects occurring.

Secondly, we can show that solutions to (\ref{eq:sda}--d) satisfy a discrete
analogue of (\ref{eq:conserved}). To see this, choose $\chi = 1$ in
(\ref{eq:sdc}) and $\varphi= (\charfcn{\Omega_-^h(t)} -
\frac{\vol(\Omega_-^h(t))}{\vol(\Omega)})
\in \pnormspace^h(t)$ in (\ref{eq:sdb}), to obtain
\begin{align}\label{eq:stokes_volume_semidiscrete}
\ddt \vol(\Omega_-^h(t))  &=
\left\langle \V^h , \vec\nu^h \right\rangle_{\Gamma^h(t)}
= \left\langle \V^h , \vec\nu^h \right\rangle^h_{\Gamma^h(t)}
= \left\langle \vec U^h, \vec\nu^h \right\rangle_{\Gamma^h(t)} \\ &
= \int_{\Omega_-^h(t)} \nabla\,.\,\vec U^h \dL{d} =0\,.
\end{align}
Hence solution to (\ref{eq:sda}--d) conserve the enclosed volume. Once again,
the fully discrete scheme (\ref{eq:HGa}--d) inherits this property in the sense
that in our simulations the volumes are always well maintained, with the
observed relative volume loss tending to zero as $\tau\to 0$.

\section{Algebraic formulation}\label{sec:stokes_algebraic_system}
As is standard practice for the solution of linear systems arising from
discretizations of (Navier--)Stokes equations, we avoid the complications of the
constrained pressure space $\pnormspace^m$ in practice by considering an
overdetermined linear system with $\pspace^m$ instead. In a post-processing step
the computed pressure is then projected into the space of zero mean
functions. The adoption of the unconstrained pressure space $\pspace^m$
requires particular care when the Dirichlet boundary data $\vec g$ is different
from zero. Indeed, let $\varphi \in \pspace^m$, then we can rewrite $\varphi$ as
\begin{equation}\label{eq:phi_rewriting}
\varphi=\varphi-\frac{\left(\varphi,1\right)}{\left(1,1\right)}
+\frac{\left(\varphi,1\right)}{\left(1,1\right)}\,,
\end{equation}
where $\varphi-\frac{(\varphi,1)}{(1,1)}\in\pnormspace^m$ and
$\frac{(\varphi,1)}{(1,1)}\in\R$. Substituting (\ref{eq:phi_rewriting}) in
(\ref{eq:HGb}) we obtain
\begin{equation}
\left(\nabla\,.\,\vec U^{m+1}, \varphi\right)  =
\left(\nabla\,.\,\vec U^{m+1},
\varphi-\frac{\left(\varphi,1\right)}{\left(1,1\right)}\right) +
\left(\nabla\,.\,\vec U^{m+1},1\right)
\frac{\left(\varphi,1\right)}{\left(1,1\right)}\,,
\end{equation}
but, from (\ref{eq:HGb}), we have
\begin{equation}
\left(\nabla\,.\,\vec U^{m+1},
\varphi-\frac{\left(\varphi,1\right)}{\left(1,1\right)}\right) = 0\,,
\end{equation}
and, noting that
\begin{equation}
\left(\nabla\,.\,\vec U^{m+1}, 1\right)=
\frac{\left(\varphi,1\right)}{\left(1,1\right)}\, \int_{\partial\Omega}
\vec U^{m+1}\,.\, \unitn \dH{d-1}=
\frac{\left(\varphi,1\right)}{\vol(\Omega)}\, \int_{\partial_1\Omega}
(\vec I^m_2\,\vec g) \,.\, \unitn \dH{d-1}\,,
\end{equation}
we finally deduce
\begin{equation} \label{eq:LAb}
 \left(\nabla\,.\,\vec U^{m+1}, \varphi\right) =
 \frac{\left(\varphi, 1\right)}{\vol(\Omega)}\, \int_{\partial_1\Omega}
(\vec I^m_2\,\vec g) \,.\, \unitn \dH{d-1} \quad \forall\ \varphi \in
\pspace^m\,.
\end{equation}
Therefore, when the inhomogeneous boundary data $\vec g$ is non-quadratic and,
as in our case, the pressure space used is the unconstrained space $\pspace^m$
instead of $\pnormspace^m$, then the equation (\ref{eq:LAb}) replaces
(\ref{eq:HGb}) and the resulting weak formulation is
\begin{subequations}
\begin{align}
& 2\left(\mu\,\mat D(\vec u), \mat D(\vec \xi)\right)
- \left(p, \nabla\,.\,\vec \xi\right)
- \gamma\,\left\langle \varkappa\,\vec\nu, \vec\xi\right\rangle_{\Gamma(t)}
= \left(\vec f, \vec \xi\right)\quad \forall\ \vec\xi \in \uspace 0 \,,
\label{eq:HGcorrecteda}\\
& \left(\nabla\,.\,\vec U^{m+1}, \varphi\right) =
 \frac{\left(\varphi, 1\right)}{\vol(\Omega)}\, \int_{\partial_1\Omega}
(\vec I^m_2\,\vec g) \,.\, \unitn \dH{d-1} \quad \forall\ \varphi \in
\pspace^m\,, \label{eq:HGcorrectedb} \\
&  \left\langle \V - \vec u, \chi\,\vec\nu \right\rangle_{\Gamma(t)} = 0
\quad \forall\ \chi \in H^1(\Gamma(t))\,, \label{eq:HGcorrectedc} \\
& \left\langle \varkappa\,\vec\nu, \vec\eta \right\rangle_{\Gamma(t)}
+ \left\langle \nabs\,\vec \id, \nabs\,\vec \eta \right\rangle_{\Gamma(t)}
= 0  \quad \forall\ \vec\eta \in [H^1(\Gamma(t))]^d\,. \label{eq:HGcorrectedd}
\end{align}
\end{subequations}
Let $\uspacesimple^m$ be unconstrained velocity space, with basis
$\{\phi_i^{\uspacesimple^m}\}_{i=1}^{K^m_\uspacesimple}$. Moreover, let
$\{\phi_i^{\pspace^m}\}_{i=1}^{K^m_\pspace}$ span the unconstrained pressure
space $\pspace^m$ and let
$\{\chi_i^m\}_{i=1}^{K_\Gamma}$ be the basis of $\Wh$. Then, ignoring for now
the Dirichlet and free-slip boundary condition, the resulting linear system can
be formulated as: Find ${(\vec U^{m+1},P^{m+1},
\kappa^{m+1},\delta\vec X^{m+1})\in (\R^d)^{K^m_\uspacesimple}\times
\R^{K^m_\pspace} \times \R^{K_\Gamma}\,\times (\R^d)^{K_\Gamma}}$, where $\vec
X^{m+1} = \vec X^m+ \delta\vec X^{m+1}$, such that
\begin{equation}
\begin{pmatrix}
\vec B_\Omega & \vec C_\Omega & -\gamma\,\Nbulk & 0 \\
\vec C^T_\Omega & 0 & 0 & 0 \\
\NbulkT & 0 & 0 & -\frac1{\tau_m}\,\vec N_\Gamma^T \\
0 & 0 & \vec N_\Gamma & \vec A_\Gamma
\end{pmatrix}
\begin{pmatrix}
\vec U^{m+1} \\
P^{m+1} \\
\kappa^{m+1} \\
\delta\vec X^{m+1}
\end{pmatrix}
=
\begin{pmatrix}
\vec c \\
\vec \beta \\
0 \\
-\vec A_\Gamma\,\vec X^m
\end{pmatrix} \,,
\label{eq:stokes_algebraic}
\end{equation}
where $(\vec U^{m+1},P^{m+1},\kappa^{m+1},\delta\vec X^{m+1})$ here denote the
coefficients of these finite element functions with respect to the
aforementioned functions. Moreover, $\vec X^m$ denotes the coefficients of
$\vec\id\!\mid_{\Gamma^m}$ with respect to the basis of $\Vh$. The definitions
of the matrices and vectors in (\ref{eq:stokes_algebraic}) directly follow from
(\ref{eq:HGcorrecteda}--d) and are:
\begin{align*}
& [\vec B_\Omega]_{ij} := 2\left(\left(\mu^m\,\mat D(\phi_j^{\uspacesimple^m}
\vec e_q), \mat D( \phi_i^{\uspacesimple^m}\,\vec e_r) \right)
\right)_{q,r=1}^d\,,\quad
\vec c_i := \left( \vec f^{m+1},\phi_i^{\uspacesimple^m}\right)\,,\\
&[\vec C_\Omega]_{ip} := - \left(
\left(\nabla\,.\,(\phi_i^{\uspacesimple^m}\,\vec
e_q), \phi_p^{\pspace^m} \right) \right)_{q=1}^d,\quad
[\Nbulk]_{il} := \left\langle \phi_i^{\uspacesimple^m}, \chi^m_l \,\vec\nu^m
\right\rangle_{\Gamma^m} \,,\\
& \vec \beta_i := \frac{\left(\phi_i^{\pspace^m},1\right)}{\left(1,1\right)}
\left\langle \vec I_2^m\,\vec g,\unitn\right\rangle_{\partial_1\Omega}\,,\quad
[\vec N_\Gamma]_{kl} := \left\langle \chi^m_l, \chi^m_k\,\vec\nu^m
\right\rangle_{\Gamma^m}^h \,,\\
& [\vec A_\Gamma]_{kl} := \left\langle \nabs\,\chi^m_l, \nabs\,\chi^m_k
\right\rangle_{\Gamma^m} \,\vec\id \,,
\end{align*}
where $\{\vec e_q\}_{q=1}^d$ denotes the standard basis in $\R^d$. Note that
for the submatrices we have used the convention that the subscripts refer to
the test and trial domains, respectively. A single subscript is used where the
two domains are the same.

The Dirichlet boundary condition is imposed doctoring the matrix and the
right-hand side of algebraic system (\ref{eq:stokes_algebraic}). The matrix
doctoring process consists on zeroing the rows which correspond to the Dirichlet
boundary degree of freedoms and setting an unitary value on the correspondent
diagonal entries. The vector doctoring process consists on setting the Dirichlet
boundary data on the correspondent right-hand side entries. Similarly, the
free-slip boundary condition is enforced doctoring the matrix entries which
correspond to the degree of freedoms of the basis functions perpendicular to
$\partial_2\Omega$. Instead, the right-hand side is left unchanged.

We observe the analogy of the interface part of the algebraic system,
namely the matrices $[\vec A_\Gamma]$ and $[\vec N_\Gamma]$ and the right-hand
side term $-\vec A_\Gamma\,\vec X^m$, with the algebraic system arising
from the mean curvature flow (\ref{eq:algebraic_mean_curvature}) and surface
diffusion (\ref{eq:algebraic_surf_diff}).

\section{Solution method}\label{sec:stokes_solution_method}
For the solution of (\ref{eq:stokes_algebraic}) we use a Schur complement
approach that eliminates $(\kappa^{m+1}, \delta \vec X^{m+1})$ from
(\ref{eq:stokes_algebraic}), and then use an iterative solver for the remaining
system in $(\vec U^{m+1}, P^{m+1})$. This approach has the advantage that for
the reduced system well-known solution methods for finite element
discretizations for standard (Navier--)Stokes discretizations may be employed.
The desired Schur complement can be obtained as follows. Let
\begin{equation} \label{eq:Xi}
\Xi_\Gamma:= \begin{pmatrix}
 0 & - \frac1{\tau_m}\,\vec N_\Gamma^T \\
\vec N_\Gamma & \vec A_\Gamma
\end{pmatrix} \,,
\end{equation}
be the interface condensed operator, which is exactly the same operator
(\ref{eq:algebraic_initial_curvature}) arising from the discretization of the
stationary geometric PDE. Then (\ref{eq:stokes_algebraic}) can be reduced to
\begin{subequations}
\begin{equation} \label{eq:SchurkX}
\begin{pmatrix}
\vec B_\Omega + \gamma\,(\Nbulk \ 0)\,\Xi_\Gamma^{-1}\,
\binom{\NbulkT}{0} & \vec C_\Omega \\
\vec C_\Omega^T & 0
\end{pmatrix}
\begin{pmatrix}
\vec U^{m+1} \\ P^{m+1}
\end{pmatrix}
= \begin{pmatrix}
\vec c
+\gamma\,(\Nbulk \ 0)\, \Xi_\Gamma^{-1}\,
\binom{0}{-\vec A_\Gamma\,\vec X^m} \\
\vec \beta
\end{pmatrix}
\end{equation}
and
\begin{equation}
\binom{\kappa^{m+1}}{\delta\vec X^{m+1}} = \Xi_\Gamma^{-1}\,
\binom{-\NbulkT\,\vec U^{m+1}}{-\vec A_\Gamma\,\vec X^m}\,.
\label{eq:SchurkXb}
\end{equation}
\end{subequations}

We notice that when $\gamma = 0$ the linear system (\ref{eq:SchurkX}) becomes
\begin{equation} \label{eq:stokes_system}
\begin{pmatrix}
\vec B_\Omega & \vec C_\Omega \\
\vec C_\Omega^T & 0
\end{pmatrix}
\begin{pmatrix}
\vec U^{m+1} \\ P^{m+1}
\end{pmatrix}
= \begin{pmatrix}
\vec c \\
\vec \beta
\end{pmatrix}\,,
\end{equation}
which for $\mu_+=\mu_-$ corresponds to a discretization of the one-phase
Stokes problem. This system is well known and a classical way to solve it is to
use a preconditioned GMRES iteration. The generalized minimal residual method
(GMRES) is an iterative method for non-symmetric systems. It generates a
sequence of orthogonal vectors using the Arnoldi method which is a modified
Gram-Schmidt orthogonalization applied to a Krylov subspace with minimal
residual. See \cite{BarrettBCetal94} for more details. Therefore, we solve
(\ref{eq:SchurkX}), which is a slight modification of (\ref{eq:stokes_system}),
employing a preconditioned GMRES iterative solver. For the inverse
$\Xi_\Gamma^{-1}$ we employ a sparse $L\,U$ decomposition, which we obtain with
the help of the sparse factorization package UMFPACK, see \cite{Davis04}, in
order to reuse the factorization. Having obtained $(\vec U^{m+1}, P^{m+1})$ from
(\ref{eq:SchurkX}), we solve (\ref{eq:SchurkXb}) for $(\kappa^{m+1}, \delta\vec
X^{m+1})$.

As regarding the preconditioner, see \cite{ElmanSW05} for more details, a
possible choice is to use the preconditioner
\begin{equation} \label{eq:ESW}
\mathcal{P} = \begin{pmatrix}
\vec{\mathcal{P}}_{\vec B} & \vec C_\Omega \\
0 & -\mathcal{P}_S
\end{pmatrix}\,,
\end{equation}
where $\vec{\mathcal{P}}_{\vec B}$ is some preconditioner for the matrix $\vec
B_\Omega$, and $\mathcal{P}_S$ acts as a preconditioner for the bulk Schur
complement operator $S_\Omega=\vec C^T_\Omega \,\vec B_\Omega^{-1}\,\vec
C_\Omega$.

An application of the preconditioner (\ref{eq:ESW}) amounts to solving the
equations
\begin{equation*}
\begin{pmatrix}
\vec{\mathcal{P}}_{\vec B} & \vec C_\Omega \\
0 & -\mathcal{P}_S
\end{pmatrix}
\begin{pmatrix} \vec U \\ P \end{pmatrix}
= \begin{pmatrix} \vec v \\ q \end{pmatrix}
\end{equation*}
which, by backward substitution, is equivalent to
\begin{equation}\label{eq:blocksolution}
\mathcal{P}_S\,P = -q\,,\quad \vec{\mathcal{P}}_{\vec B}\,\vec U = \vec v -
\vec C_\Omega\,P\,.
\end{equation}
We choose $\vec B_\Omega$  for $\vec{\mathcal{P}}_{\vec B}$ and the pressure
mass matrix $M_\Omega$ defined as
\begin{equation*}
[M_\Omega]_{ij} = \left(\,\phi_j^{\pspace^m},\, \phi_i^{\pspace^m}\right)\,.
\end{equation*}
for $\mathcal{P}_S$. Again, in order to reuse the factorization, we employ a
sparse $L\,U$ decomposition to factorize the matrices $\vec B$ and $M_\Omega$.

Alternatively, it is possible to use the standard Stokes matrix, see
(\ref{eq:stokes_system}),
\begin{equation}\label{eq:stokes_direct_precond}
\begin{pmatrix}
\vec B_\Omega & \vec C_\Omega \\
\vec C_\Omega^T & 0
\end{pmatrix}\,
\end{equation}
as a preconditioner and factorize them directly with a sparse $L\,U$
decomposition. Since in the Stokes problem the pressure solution is unique up
to a constant, the matrix (\ref{eq:stokes_direct_precond}) has rank deficiency
1. Therefore, in order to use UMFPACK to factorize the matrix, the rank
deficiency needs to be reduced to 0. This can be achieved using a matrix
doctoring which consists on setting, for example, an unitary value on the first
diagonal entry of the null matrix. This doctoring process can be avoided if SPQR
is used to factorize the preconditioner since SPQR can decompose also singular
matrices. We stress the fact that the rank deficiency is exactly 1 only for LBB
stable pairs otherwise the rank deficiency may be much higher.

The algebraic system (\ref{eq:stokes_algebraic}) is suitable adjusted when we
use (P1+P0) or \pdg as pressure space. Indeed it assumes the following form
\begin{equation}
\begin{pmatrix}
\vec B_\Omega & \vec C_{\spadesuit} & \vec C_{\clubsuit} & -\gamma\,\Nbulk & 0\\
\vec C^T_{\spadesuit} & 0 & 0 & 0 & 0 \\
\vec C^T_{\clubsuit} & 0 & 0 & 0 & 0 \\
\NbulkT & 0 & 0 & 0 & -\frac1{\tau_m}\,\vec N_\Gamma^T \\
0 & 0 & 0 & \vec N_\Gamma & \vec A_\Gamma
\end{pmatrix}
\begin{pmatrix}
\vec U^{m+1} \\
P^{m+1}_\spadesuit \\
P^{m+1}_\clubsuit \\
\kappa^{m+1} \\
\delta\vec X^{m+1}
\end{pmatrix}
=
\begin{pmatrix}
\vec c \\
\vec \beta_\spadesuit \\
\vec \beta_\clubsuit \\
0 \\
-\vec A_\Gamma\,\vec X^m
\end{pmatrix} \,,
\label{eq:stokes_algebraic_extended}
\end{equation}
where $\vec C_{\spadesuit}$ and $\vec C_{\clubsuit}$ have the same definition
of $\vec C_\Omega$ in (\ref{eq:stokes_algebraic}) but over different spaces.
More precisely, in the case (P1+P0), there are two independent spaces for the
pressure of polynomial order 1 and 0, respectively. Instead, in the case \pdg,
both spaces have polynomial degree 1 but the basis functions support is
$\Omega_-$ and $\Omega_+$, respectively.

A suitable preconditioner for the algebraic system
(\ref{eq:stokes_algebraic_extended}) is then
\begin{equation} \label{eq:ESW_extended}
\mathcal{P} = \begin{pmatrix}
\vec{\mathcal{P}}_{\vec B} & \vec C_\spadesuit & \vec C_\clubsuit \\
0 & -\mathcal{P}_{S,\spadesuit} & 0 \\
0 & 0 &-\mathcal{P}_{S,\clubsuit}
\end{pmatrix}\,,
\end{equation}
while the reduced system becomes
\begin{subequations}
\begin{equation} \label{eq:SchurkX_extended}
\begin{pmatrix}
\vec B_\Omega + \gamma\,(\Nbulk \ 0)\,\Xi_\Gamma^{-1}\,\binom{\NbulkT}{0} &
\vec C_\spadesuit & \vec C_\clubsuit \\
\vec C^T_\spadesuit & 0 & 0 \\
\vec C^T_\clubsuit & 0 & 0 \\
\end{pmatrix}
\begin{pmatrix}
\vec U^{m+1} \\
P^{m+1}_\spadesuit \\
P^{m+1}_\clubsuit
\end{pmatrix}
= \begin{pmatrix}
\vec c+\gamma\,(\Nbulk \ 0)\,
\Xi_\Gamma^{-1}\,\binom{0}{-\vec A_\Gamma\,\vec X^m} \\
\vec \beta_\spadesuit \\
\vec \beta_\clubsuit
\end{pmatrix}\,.
\end{equation}
\end{subequations}
An application of the preconditioner amounts to solving the equations
\begin{equation*}
\begin{pmatrix}
\vec{\mathcal{P}}_{\vec B} & \vec C_\spadesuit & \vec C_\clubsuit \\
0 & -\mathcal{P}_{S,\spadesuit} & 0 \\
0 & 0 &-\mathcal{P}_{S,\clubsuit}
\end{pmatrix}
\begin{pmatrix}
\vec U \\
P_\spadesuit \\
P_\clubsuit
\end{pmatrix}
=
\begin{pmatrix}
\vec v \\
q \\
p
\end{pmatrix}
\end{equation*}
which, by backward substitution, is equivalent to
\begin{equation}\label{eq:blocksolution_extended}
\mathcal{P}_{S,\spadesuit}\,P_\spadesuit =
-q\,,\quad \mathcal{P}_{S,\clubsuit}\,P_\clubsuit =
-p\,,\quad \vec{\mathcal{P}}_{\vec B}\,\vec U =
\vec v - \vec C_\spadesuit\,P_\spadesuit - \vec C_\clubsuit\,P_\clubsuit\,.
\end{equation}

Alternatively, as before, it is possible to use the standard Stokes matrix
\begin{equation}\label{eq:stokes_direct_precond_extended}
\begin{pmatrix}
\vec B_\Omega & \vec C_\spadesuit & \vec C_\clubsuit \\
\vec C^T_\spadesuit & 0 & 0 \\
\vec C^T_\clubsuit & 0 & 0 \\
\end{pmatrix}
\end{equation}
as a preconditioner and factorize them directly with a sparse $L\,U$
decomposition. The matrix (\ref{eq:stokes_direct_precond_extended}) has rank
deficiency 1 for the P2--\pdg element and 2 for the P2--(P1+P0) element.
Therefore, in the case P2--\pdg, only the first null diagonal matrix is
doctored while, in the case P2--(P1+P0), both null diagonal matrices are
doctored. Again, we point out that the doctoring is not needed when SPQR is used
to factorize the preconditioner.

\section{Mesh generation and smoothing}\label{sec:stokes_smoothing}
Given the initial polyhedral surface $\Gamma^0$, we create a triangulation
$\mathcal{T}^0$ of $\Omega$ that is fitted to $\Gamma^0$ with the help of the
package \verb|Gmsh|, see \cite{GeuzaineR09}.

The mesh generation process is controlled by the characteristic lengths of the
points describing the geometry of the domain boundary $\partial\Omega$. Each
point has associated a characteristic length which prescribes the size of the
mesh elements. For example, a segment of length $L$, which defines an edge of
the domain boundary, delimited by two points of characteristic length $c_l$ will
be subdivided into several segments of lengths $\frac{L}{c_l}$ during the mesh
generation. Therefore, the smaller is the characteristic length, the finer is
the resulting mesh. When the characteristic lengths of two points defining an
edge are different, \verb|Gmsh| performs an interpolation process. In general we
use either nearly uniform or adaptive bulk meshes. In the former case, the
characteristic length $c_l$ is set to be equal to the characteristic length of
the interface $c_{l,\Gamma}$, while in the latter case the characteristic
length is $c_l(\vec z)=\min\{8c_{l,\Gamma},\mbox{dist}(\vec z,\Gamma)\}$.
Therefore, in the adaptive case, if the interface is far enough from the
boundary, the resulting bulk mesh will be coarse. We define the characteristic
length of the interface $c_{l,\Gamma}$, in the 2d case, as the average length
of the segments describing the discrete interface $\Gamma^m$ or, in the 3d
case, as the length of an equilateral triangle with area equal to the average
of the areas of the triangles describing the discrete interface $\Gamma^m$.

Then, for $m \geq 0$, having computed the new interface $\Gamma^{m+1}$, we
would like to obtain a bulk triangulation $\mathcal{T}^{m+1}$ that is fitted to
$\Gamma^{m+1}$, and ideally is close to $\mathcal{T}^m$. This is to avoid
unnecessary overhead from remeshing the domain $\Omega$ completely.

To this end, we perform the following smoothing step on $\mathcal{T}^m$, which
is inspired by the method proposed in \cite{Ganesan06}, see also
\cite{GanesanT08}. Having obtained $\delta \vec X^{m+1}$ from the solution of
(\ref{eq:stokes_algebraic}), we solve the linear elasticity problem: Find a
displacement
$\vec\psi \in [H^1(\Omega)]^d$ such that
\begin{subequations}
\begin{alignat}{2}
\nabla\,.\,\mat S & = \vec 0 \quad &&\mbox{in } \Omega_\pm^m\,,
\label{eq:elasta}\\
\vec\psi &= \delta \vec X \quad && \mbox{on } \Gamma^m\,, \label{eq:elastb} \\
\vec\psi\,.\,\unitn & = 0 \quad &&\mbox{on } \partial\Omega\,,
\label{eq:elastc}
\end{alignat}
\end{subequations}
where the stress tensor $\mat S$ is defined as
\begin{equation} \label{eq:elasticity_tensor}
\mat S = 2\,\mat D(\vec\psi) + (\nabla\,.\vec\psi)\,\mat\id
\end{equation}
and where $\unitn$ in (\ref{eq:elastc}) is the outer unit normal to
$\Omega$ on $\partial\Omega$. In practice we approximate (\ref{eq:elasta}--c)
with piecewise linear elements and solve the resulting system of linear
equations with the UMPFACK package, see \cite{Davis04}. The obtained discrete
variant of $\vec\psi$, at every vertex of the current bulk grid
$\mathcal{T}^m$, then represents the variation in their position that we
compute in order to obtain $\mathcal{T}^{m+1}$.

Occasionally the deformation of the mesh becomes too large, for instance when
the bubble making up the inner phase undergoes strong deformations, and so a
complete remeshing of $\Omega$ becomes necessary. In order to detect the need
for a complete remeshing, we define the volume criterion
\begin{equation}\label{eq:volume_criterion}
\frac{\max_{\sigmaO\in {\cal T}^{m+1}}\vol(\sigmaO)}
{\min_{\sigmaO\in\mathcal {T}^{m+1}}\vol(\sigmaO)} \geq C_v \geq 1,
\end{equation}
where $C_v$ is a fixed constant. Of course, if we choose $C_v = 1$, then a
remeshing would be triggered after every time step. Obviously, the
volume criterion (\ref{eq:volume_criterion}) cannot be used for adaptive
meshes therefore we also define the angle criterion
\begin{equation}\label{eq:angle_criterion}
\min_{\sigmaO\in {\cal T}^{m+1}}\min_{\alpha\in \measuredangle(\sigmaO)}\alpha
\leq C_a\,,
\end{equation}
where $\measuredangle(\sigmaO)$ is the set of all the angles of the simplex
$\sigmaO$ which can be computed as $\alpha_{ij}=\cos^{-1}(-\vec n_i\,.\,\vec
n_j)$, $\forall i,j\in\{0,\dots,d\}$, with $\vec n_i$ the unitary normal to the
simplex face $i$. Of course, if we chose $C_a=20$\textdegree, then a remeshing
is triggered after every time step.

We stress that in all our numerical simulations we never need to remesh the
interface $\Gamma^m$ itself. Hence the stability results from
Theorem~\ref{thm:stabstab} hold throughout. Of course, a remeshing of $\Gamma^m$
would mean that (\ref{eq:stab}) in Theorem~\ref{thm:stabstab} is no longer
valid because the re-meshed interface $\hat{\Gamma}^m$ differs from the
computed $\Gamma^m$.

\section{Numerical results}\label{sec:stokes_results}
In order to test our method, and to allow comparisons with the unfitted finite
element approximation in \cite{spurious}, we recall the following stationary
and expanding spherical solutions from \cite{spurious}. Let $\Gamma(t) = \{ \vec
z \in \R^d : |\vec z| = r(t)\}$ be a sphere of radius $r(t)$ and curvature
$\kappa(t) = -\,\frac{d-1}{r(t)}$. Moreover let $\alpha,\gamma\in \R_{\geq 0}$
be given.

Firstly, the stationary sphere where
\begin{subequations}
\begin{equation} \label{eq:radialr}
r(t) = r(0)\,,
\end{equation}
together with
\begin{equation} \label{eq:radialup}
\vec u(\vec z, t) = \vec 0 \,,\quad p(\vec z, t) =
-\,\gamma \kappa(0)\left[\charfcn{\Omega_-(0)}
-\frac{\vol(\Omega_-(0))}{\vol(\Omega)} \right] ,
\end{equation}
\end{subequations}
is an exact solution to the problem (\ref{eq:stokes_full_momentum}--h) on e.g.\
$\Omega = (-1,1)^d$ with $\vec f=\vec 0$ and $\vec g = \vec 0$ on
$\partial_1\Omega=\partial\Omega$. This solution is the continuous version of
(\ref{eq:solsol}). Secondly, a nontrivial divergence free and radially
symmetric solution $\vec u$ can be constructed on a domain that does not
contain the origin. To this end, consider e.g. $\Omega = (-1,1)^d \setminus
[-\frac13,\frac13]^d$. Then, the expanding sphere where
\begin{subequations}
\begin{equation} \label{eq:radialr2}
r(t) = ([r(0)]^d + \alpha\,t\,d)^\frac1d \,,
\end{equation}
together with
\begin{equation} \label{eq:radialup2}
\vec u(\vec z, t) = \alpha\,\frac{\vec z}{|\vec z\,|^d}\,, \quad
p(\vec z, t) = -\,\bigg(\gamma +2\,\alpha\,\frac{\mu_+ - \mu_-}
{r(t)^{d-1}}\bigg)\,\kappa(t)\,\left[ \charfcn{\Omega_-(t)} -
\frac{\vol(\Omega_-(t))}{\vol(\Omega)}\right],
\end{equation}
\end{subequations}
is an exact solution to the problem (\ref{eq:stokes_full_momentum}--h) with
$\vec f = \vec 0$ and $\vec g(\vec z) = \alpha\,|\vec z|^{-d}\,\vec z$ on
$\partial_1\Omega=\partial\Omega$. We will refer to (\ref{eq:radialr},b) as the
stationary bubble solution, and to (\ref{eq:radialr2},b) as the expanding bubble
solution.

In our numerical simulations, unless otherwise stated, we use the following
settings. We choose the initial surface $\Gamma(0) = \{ \vec z \in \R^d : |\vec
z| = \frac12 \}$, the domain $\Omega = (-1,1)^d$ and we employ uniform time
steps $\tau_m=\tau$, $m=0,\ldots, M-1$. Moreover, we set the GMRES tolerance to
tol $=10^{-12}$ and the restart value to 50. We use the Stokes matrix
(\ref{eq:stokes_direct_precond}) or, depending on the pressure space,
(\ref{eq:stokes_direct_precond_extended}) as a preconditioner factorizing it
with UMFPACK. We point out that the restart value corresponds to the size
of the Krylov subspace used by the GMRES method while the tolerance is the
value for the stopping criterion. More precisely, the GMRES iteration ends when
the ratio between the norm of the preconditioned actual residual and the norm
of the preconditioned initial residual is smaller than the required tolerance.

Finally, we define the errors
\begin{equation} \label{eq:errorXx}
\errorXx := \max_{m=1,\ldots, M} \|\Gamma^m - \Gamma(t_m)\|_{L^\infty}\,,
\end{equation}
where $\|\Gamma^m - \Gamma(t_m)\|_{L^\infty} :=
\max_{k=1,\ldots, K_\Gamma} {\rm dist}( \vec q^m_k, \Gamma(t_m))$,
\begin{equation} \label{eq:errorLUu}
\LerrorUu2 := \left[\tau\,\sum_{m=1}^M \|\vec U^m - I^m_2\,\vec u(\cdot,
t_m)\|_{L^2(\Omega)}^2 \right]^\frac12,
\end{equation}
\begin{equation} \label{eq:errorHUu}
\HerrorUu2 := \left[\tau\,\sum_{m=1}^M \|\vec U^m - I^m_2\,\vec u(\cdot,
t_m)\|_{H^1(\Omega)}^2 \right]^\frac12,
\end{equation}
and
\begin{equation} \label{eq:errorPp}
\LerrorPp := \left[\tau\,\sum_{m=1}^M \|P^m - p(\cdot,t_m)\|_{L^2(\Omega)}^2
\right]^\frac12.
\end{equation}
In (\ref{eq:errorPp}) we employ a quadrature rule of degree $k$, with $k=13$ in
2d and $k=10$ in 3d, to compute the $L^2$--norms over $\Omega$. We also define
the estimated error of convergence EOC as
\begin{equation} \label{eq:eoc}
\mbox{EOC}=\frac{\ln{\frac{\mbox{error}_1}{\mbox{error}_0}}}
{\ln{\frac{\mbox{h}_1}{\mbox{h}_0}}}\,,
\end{equation}
where $\mbox{error}_1$ is the error computed on a triangulation finer that the
one used to compute $\mbox{error}_0$ while $\mbox{h}_1$ and $\mbox{h}_0$ are the
respective characteristic lengths.

\subsection{Convergence tests in 2d} \label{sec:stokes_2d_convergence_results}
For the true solution (\ref{eq:radialr},b) we choose $\mu = \gamma = 1$.
Therefore, the solution reduces to $r(t) =
\frac{1}{2}$, $\vec u(\cdot, t) = \vec 0$ and $p(t) = 2\,\charfcn{\Omega_-(0)} -
\frac{\pi}{8}$ for all $t \geq 0$. We approximate this stationary solution on
nearly uniform meshes that feature $J_\Gamma = 2^i$, $i=4,\ldots,7$, uniform
interface elements and $J_\Omega^0 = 224$, $1076$, $4240$, $17194$ bulk
elements, respectively. We show the initial mesh for $J_\Gamma = 32$ in
Figure~\ref{fig:meshes_uniform}.
\begin{figure}[htbp]
\centering
\includegraphics[width=.45\textwidth]{figures/stokes/mesh_uniform.ps}
\caption[Stokes 2d stationary bubble initial mesh]
{Initial mesh for the 2d stationary bubble problem with $J_\Gamma = 32$
interface elements.}
\label{fig:meshes_uniform}
\end{figure}
In addition, we use a uniform time step size $\tau=10^{-2}$.
We compute the discrete solutions to this stationary problem over the time
interval $[0,1]$, and report on the errors for the P2--P0, P2--P1, P2--\pdg
and P2--(P1+P0) elements in Tables~\ref{tab:stokes_stationary_2d_p2p0},
\ref{tab:stokes_stationary_2d_p2p1}, \ref{tab:stokes_stationary_2d_p2p1dg} and
\ref{tab:stokes_stationary_2d_p2p1p0}, respectively.
\begin{table*}
\center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 16 & 0 & 0 & 3.22254e-01 &    - &    9 \\
 32 & 0 & 0 & 1.41195e-01 & 0.90 &   54 \\
 64 & 0 & 0 & 4.06438e-02 & 1.80 &  292 \\
128 & 0 & 0 & 2.60448e-02 & 0.64 & 1443 \\
\hline
\end{tabular}
\caption[Stokes 2d stationary bubble errors P2--P0]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^2$ over the time
interval $[0,1]$ for the P2--P0 element.}
\label{tab:stokes_stationary_2d_p2p0}
\end{table*}
\begin{table*}
\center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 16 & 2.41133e-02 & 9.35478e-03 & 5.75614e-01 &    - &    5 \\
 32 & 1.21789e-02 & 3.44473e-03 & 3.99457e-01 & 0.40 &   36 \\
 64 & 6.17055e-03 & 1.24629e-03 & 2.77632e-01 & 0.52 &  170 \\
128 & 2.97451e-03 & 4.41980e-04 & 1.96901e-01 & 0.50 & 1343 \\
\hline
\end{tabular}
\caption[Stokes 2d stationary bubble errors P2--P1]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^2$ over the time
interval $[0,1]$ for the P2--P1 element.}
\label{tab:stokes_stationary_2d_p2p1}
\end{table*}
\begin{table*}
\center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 16 & 0 & 0 & 3.22254e-01 &    - &    8 \\
 32 & 0 & 0 & 1.41195e-01 & 0.90 &   42 \\
 64 & 0 & 0 & 4.06438e-02 & 1.80 &  181 \\
128 & 0 & 0 & 2.60448e-02 & 0.64 & 1006 \\
\hline
\end{tabular}
\caption[Stokes 2d stationary bubble errors P2--\pdg]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^2$ over the time
interval $[0,1]$ for the P2--\pdg element.}
\label{tab:stokes_stationary_2d_p2p1dg}
\end{table*}
\begin{table*}
 \center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 16 & 0 & 0 & 3.22254e-01 &    - &   13 \\
 32 & 0 & 0 & 1.41195e-01 & 0.90 &   44 \\
 64 & 0 & 0 & 4.06438e-02 & 1.80 &  203 \\
128 & 0 & 0 & 2.60448e-02 & 0.64 & 2151 \\
\hline
\end{tabular}
\caption[Stokes 2d stationary bubble errors P2--(P1+P0)]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^2$ over the time
interval $[0,1]$ for the P2--(P1+P0) element.}
\label{tab:stokes_stationary_2d_p2p1p0}
\end{table*}

We can clearly see that the stationary nature of the true solution
(\ref{eq:radialr},b) is captured exactly by our numerical method with the
P2--P0, the P2--\pdg and the P2--(P1+P0) element, see also
Figure~\ref{fig:2d_stationary_bubble} for a visualization of the discrete
pressure in the case $J_\Gamma = 32$. This is not surprising given the
result of Theorem~\ref{thm:stat2}, and the fact that we use an equidistributed
approximation $\Gamma^0$, which means that (\ref{eq:constcurv}) is satisfied.
Instead the element P2--P1 does not satisfy the hypothesis that
$\charfcn{\Omega^m_-}\in\pspace^m$ of Theorem~\ref{thm:stat2} and therefore the
true solution is not captured exactly. Moreover, since
$\charfcn{\Omega_-^h(t)}\not\in \mbox{ P1}$, the volume conservation property
of the semidiscrete scheme (\ref{eq:stokes_volume_semidiscrete}) does not hold
which implies that the P2--P1 element does not conserve the enclosed volume. Of
course, since the discrete solution is stationary, neither smoothing nor
remeshing is performed for the simulations in
Tables~\ref{tab:stokes_stationary_2d_p2p0},
\ref{tab:stokes_stationary_2d_p2p1}, \ref{tab:stokes_stationary_2d_p2p1dg} and
\ref{tab:stokes_stationary_2d_p2p1p0}. We also observe that the error for the
three approximations with the P2--P0, the P2--\pdg and the P2--(P1+P0)
element, respectively, produce identical errors. Again, that is to be expected,
since the pressure solution (\ref{eq:solsol})
\begin{equation*}
P^{m+1} = -\gamma\,\overline\kappa\left[\charfcn{\Omega_-^m}
- \frac{\vol(\Omega_-^m)}{\vol(\Omega)}\right]
\end{equation*}
is such that $P^{m+1}$ is independent of $\pspace^m$, and so the additional
degrees of freedom are not utilized by the pressure approximation.
\begin{figure}[htbp]
\centering
\includegraphics[width=.45\textwidth]
{figures/stokes/2d_stationary_bubble_uniform_100.ps}
\caption[Stokes 2d stationary bubble pressure]
{($\mu=\gamma=1$) Pressure of the 2d stationary bubble at time $t=1$
for the P2--P0 element.}
\label{fig:2d_stationary_bubble}
\end{figure}

For the expanding bubble test, we fix $\Omega = (-1,1)^2 \setminus
[-\frac13,\frac13]^2$ and we choose the parameters $\alpha = 0.15$ and $\mu_+ =
10\,\mu_- = \gamma = 1$ for the true solution (\ref{eq:radialr2},b). Here we
consider two different bulk mesh strategies. Either we use a nearly uniform
mesh, as shown on the left of Figure~\ref{fig:meshes_expanding}, or an adaptive
mesh that uses a finer resolution close to the interface, see the example mesh
on the right-hand side of Figure~\ref{fig:meshes_expanding}.
\begin{figure}[htbp]
\centering
\subfloat[Uniform mesh with $J_\Gamma = 32$]{
\includegraphics[width=.45\textwidth]{figures/stokes/mesh_hole_uniform.ps}}
\subfloat[Adaptive mesh with $J_\Gamma = 64$]{
\includegraphics[width=.45\textwidth]{figures/stokes/mesh_hole_adaptive.ps}}
\caption[Stokes 2d expanding bubble initial meshes]
{Initial meshes for the expanding bubble problem.}
\label{fig:meshes_expanding}
\end{figure}

Details on the discretization parameters for the nearly uniform meshes are
given in Table~\ref{tab:expandingbubble2Delements}. Here we explicitly
state the final number of bulk elements, $J_\Omega^M$, in the case $C_v = 1$
and $C_v = 3$, recall the remesh criterion (\ref{eq:volume_criterion}). In the
former the bulk is remeshed after every time step while in the latter the bulk
is remeshed when the max--min entity volume ratio is bigger than 3. Of course,
when only smoothing is employed, then the number of bulk mesh elements is
invariant, and so $J_\Omega^M = J_\Omega^0$.
\begin{table*}
\center
\begin{tabular}{rrrrr}
\hline
$J_\Gamma$ & $J_\Omega^0$ & $\tau$ & $J_\Omega^M$ for $C_v=1$ &
$J_\Omega^M$ for $C_v=3$ \\
\hline
 16 &   316 & $1.6\cdot10^{-2}$ &  120 &  184 \\
 32 &  1016 &   $4\cdot10^{-3}$ &  452 &  468 \\
 64 &  3916 &         $10^{-3}$ & 1864 & 1858 \\
128 & 15784 & $2.5\cdot10^{-4}$ & 7264 & 7263 \\
\hline
\end{tabular}
\caption[Stokes expanding bubble uniform meshes parameters]
{Discretization parameters for the 2d expanding bubble problem, nearly uniform
meshes.}
\label{tab:expandingbubble2Delements}
\end{table*}
We report on the error for the P2--P0, the P2--\pdg and the P2--(P1+P0)
element in Table~\ref{tab:expandingbubble2Dp2p0},
\ref{tab:expandingbubble2Dp2p1dg} and \ref{tab:expandingbubble2Dp2p1p0},
respectively. On the top part of the tables only mesh smoothings are applied,
in the central part the bulk mesh is remeshed after every time step while at
the bottom the bulk mesh is remeshed only when the criterion
(\ref{eq:volume_criterion}), with $C_v=3$, is not satisfied.
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rllllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & EOC & $\HerrorUu2$ & $\LerrorPp$ & EOC
& CPU[s] \\
\hline
& \multicolumn{7}{c}{no remeshing} \\
\hline
 16 & 5.94637e-03 & 7.26038e-04 &    - & 1.98118e-02 & 4.30560e-01 &    - &
9 \\
 32 & 1.47959e-03 & 3.39540e-04 & 0.83 & 1.17665e-02 & 2.27294e-01 & 0.70 &
98 \\
 64 & 3.68960e-04 & 8.66188e-05 & 1.97 & 5.82989e-03 & 1.05041e-01 & 1.11 &
1709 \\
128 & 9.20414e-05 & 5.87165e-05 & 0.56 & 6.24063e-03 & 3.18072e-02 & 1.72 &
37539 \\
\hline
& \multicolumn{7}{c}{$C_v=1$} \\
\hline
 16 & 5.92441e-03 & 5.27627e-04 &    - & 1.57505e-02 & 4.43442e-01 &    - &
59 \\
 32 & 1.46657e-03 & 1.05800e-04 & 1.75 & 5.26275e-03 & 2.14680e-01 & 0.79 &
100 \\
 64 & 3.65433e-04 & 1.48680e-05 & 2.83 & 1.50695e-03 & 8.14177e-02 & 1.40 &
2785 \\
128 & 9.12526e-05 & 1.81107e-06 & 3.04 & 3.59374e-04 & 3.69593e-02 & 1.14 &
23465 \\
\hline
& \multicolumn{7}{c}{$C_v=3$} \\
\hline
 16 & 5.94589e-03 & 5.71201e-04 &    - & 1.51195e-02 & 4.44395e-01 &    - &
41 \\
 32 & 1.47176e-03 & 1.02091e-04 & 1.88 & 4.86975e-03 & 2.13617e-01 & 0.80 &
92 \\
 64 & 3.65488e-04 & 1.50366e-05 & 2.76 & 1.50058e-03 & 8.22797e-02 & 1.38 &
1847 \\
128 & 9.12406e-05 & 1.81327e-06 & 3.05 & 3.59347e-04 & 3.69473e-02 & 1.16 &
26973 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes expanding bubble uniform mesh errors P2--P0]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Expanding bubble
problem on $(-1,1)^2\setminus[-\frac{1}{3},\frac{1}{3}]^2$ over the time
interval $[0,1]$ for the P2--P0 element with nearly uniform mesh.}
\label{tab:expandingbubble2Dp2p0}
\end{table*}
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rllllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & EOC & $\HerrorUu2$ & $\LerrorPp$ & EOC
& CPU[s] \\
\hline
& \multicolumn{7}{c}{no remeshing} \\
\hline
 16 & 5.99881e-03 & 1.42557e-03 &    - & 3.45859e-02 & 4.31784e-01 &    - &
9 \\
 32 & 1.47936e-03 & 4.11514e-04 & 1.36 & 1.28088e-02 & 2.27350e-01 & 0.70 &
82 \\
 64 & 3.69030e-04 & 1.03424e-04 & 1.99 & 6.17291e-03 & 1.05060e-01 & 1.11 &
1391 \\
128 & 9.21619e-05 & 6.12532e-05 & 0.76 & 6.21616e-03 & 3.17967e-02 & 1.72 &
31042 \\
\hline
& \multicolumn{7}{c}{$C_v=1$} \\
\hline
 16 & 5.95848e-03 & 8.38757e-04 &    - & 2.23968e-02 & 4.44061e-01 &    - &
100 \\
 32 & 1.47123e-03 & 2.22736e-04 & 1.45 & 7.70628e-03 & 2.15081e-01 & 0.79 &
728 \\
 64 & 3.65750e-04 & 2.16681e-05 & 3.36 & 1.76987e-03 & 8.15608e-02 & 1.40 &
3050 \\
128 & 9.12893e-05 & 2.33116e-06 & 3.22 & 3.96930e-04 & 3.69418e-02 & 1.14 &
25348 \\
\hline
& \multicolumn{7}{c}{$C_v=3$} \\
\hline
 16 & 5.99703e-03 & 8.59166e-04 &    - & 2.23227e-02 & 4.44656e-01 &    - &
47 \\
 32 & 1.47622e-03 & 2.03051e-04 & 1.57 & 7.04524e-03 & 2.13800e-01 & 0.80 &
145 \\
 64 & 3.65886e-04 & 2.21067e-05 & 3.20 & 1.77973e-03 & 8.20109e-02 & 1.38 &
2325 \\
128 & 9.12664e-05 & 2.33913e-06 & 3.24 & 3.97020e-04 & 3.69351e-02 & 1.15 &
26045 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes expanding bubble uniform mesh errors P2--\pdg]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Expanding bubble
problem on $(-1,1)^2\setminus[-\frac{1}{3},\frac{1}{3}]^2$ over the time
interval $[0,1]$ for the P2--\pdg element with nearly uniform mesh.}
\label{tab:expandingbubble2Dp2p1dg}
\end{table*}
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rllllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & EOC & $\HerrorUu2$ & $\LerrorPp$ & EOC
& CPU[s] \\
\hline
& \multicolumn{7}{c}{no remeshing} \\
\hline
 16 & 5.99532e-03 & 1.55402e-03 &    - & 4.09186e-02 & 4.31782e-01 &    - &
9 \\
 32 & 1.48145e-03 & 4.40335e-04 & 1.38 & 1.35501e-02 & 2.27375e-01 & 0.70 &
80 \\
 64 & 3.68601e-04 & 1.08675e-04 & 2.02 & 6.48883e-03 & 1.05064e-01 & 1.11 &
1316 \\
128 & 9.22254e-05 & 6.25696e-05 & 0.80 & 6.07813e-03 & 3.17870e-02 & 1.72 &
39375 \\
\hline
& \multicolumn{7}{c}{$C_v=1$} \\
\hline
 16 & 5.96235e-03 & 8.94203e-04 &    - & 2.61842e-02 & 4.44306e-01 &    - &
159 \\
 32 & 1.47265e-03 & 2.41779e-04 & 1.43 & 1.03858e-02 & 2.15011e-01 & 0.79 &
619 \\
 64 & 3.65605e-04 & 2.33308e-05 & 3.37 & 2.02208e-03 & 8.11222e-02 & 1.41 &
3014 \\
128 & 9.12693e-05 & 2.42966e-06 & 3.26 & 4.31820e-04 & 3.69632e-02 & 1.13 &
22128 \\
\hline
& \multicolumn{7}{c}{$C_v=3$} \\
\hline
 16 & 5.97343e-03 & 8.91171e-04 &    - & 2.46402e-02 & 4.45063e-01 &    - &
95 \\
 32 & 1.47254e-03 & 2.20844e-04 & 1.52 & 9.55901e-03 & 2.13809e-01 & 0.80 &
178 \\
 64 & 3.65587e-04 & 2.33348e-05 & 3.24 & 2.00192e-03 & 8.17655e-02 & 1.39 &
2225 \\
128 & 9.12663e-05 & 2.44147e-06 & 3.26 & 4.32699e-04 & 3.69512e-02 & 1.15 &
23265 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes expanding bubble uniform mesh errors P2--(P1+P0)]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Expanding bubble
problem on $(-1,1)^2\setminus[-\frac{1}{3},\frac{1}{3}]^2$ over the time
interval $[0,1]$ for the P2--(P1+P0) element with nearly uniform mesh.}
\label{tab:expandingbubble2Dp2p1p0}
\end{table*}
Due to the expanding motion of the interface, if no remesh is used, we observe
that over time bulk mesh elements strongly deform. This leads to large CPU
times and additional approximation errors. In particular, the strong mesh
deformations for the finest run, with $J_\Omega^0 = J_\Omega^M = 15212$, leads
to a breakdown of the convergence rate for the $L^2$-velocity error, and, for
the elements P2--P0 and P2--\pdg, an actual increase in the $H^1$-velocity
error. Instead, if remesh is applied, we observe a dramatic improvement in the
CPU times, and a significant reduction in the error quantities. In particular,
there is no deterioration of the observed convergence rates. Comparing the
errors in Tables~\ref{tab:expandingbubble2Dp2p0},
\ref{tab:expandingbubble2Dp2p1dg} and \ref{tab:expandingbubble2Dp2p1p0} we note
that element P2--\pdg and element P2--(P1+P0) performs, in term of CPU times
and errors, almost the same and they are slightly outperformed by element
P2--P0, which, together with a a remesh performed at every time step, gives the
best overall results.

The evolution of the discrete pressure solution in the case $J_\Gamma = 32$,
for the run with $C_v = 1$, can be seen in
Figure~\ref{fig:expanding_bubble_uniform}.
\begin{figure}[htbp]
\centering
\subfloat[$t=0$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_uniform_remesh_000.ps}}\\
\subfloat[$t=0.25$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_uniform_remesh_025.ps}}
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_uniform_remesh_050.ps}}\\
\subfloat[$t=0.75$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_uniform_remesh_075.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_uniform_remesh_100.ps}}
\caption[Stokes expanding bubble pressure uniform mesh]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Pressure evolution of
the 2d expanding bubble for the P2--P0 element, nearly uniform mesh.}
\label{fig:expanding_bubble_uniform}
\end{figure}
Here we note that the discontinuous jump in the pressure at the interface is
captured very well, with no oscillations being present. This is a significant
improvement on the oscillations observed in the discrete pressures for the
unfitted finite element approximation from \cite{spurious}, see e.g.\
Figure~6 in that paper.

Finally, we would also like to investigate the effect of using adaptive bulk
meshes, that are refined close to the interface. An example mesh is shown on
the right-hand side of Figure~\ref{fig:meshes_expanding}, and we list our
employed discretization parameters in
Table~\ref{tab:expandingbubble2Delements_adaptive}. Obviously the remesh
criterion (\ref{eq:volume_criterion}) cannot be used for an adaptive mesh since
it would be always violated therefore we use the angle criterion
(\ref{eq:angle_criterion}) with $C_a=20$\textdegree.
\begin{table*}
\center
\begin{tabular}{rrrrr}
\hline
$J_\Gamma$ & $J_\Omega^0$ & $\tau$ & $J_\Omega^M$ for $C_a=60$\textdegree &
$J_\Omega^M$ for $C_a=20$\textdegree \\
\hline
 32 &  460 & $6.4\cdot10^{-2}$ &  216 &  216 \\
 64 & 1040 & $1.6\cdot10^{-2}$ &  452 &  440 \\
128 & 2628 &   $4\cdot10^{-3}$ & 1084 & 1384 \\
256 & 7460 &         $10^{-3}$ & 3840 & 4004 \\
\hline
\end{tabular}
\caption[Stokes expanding bubble adaptive meshes parameters]{Discretization
parameters for the 2d expanding bubble problem, adaptive meshes.}
\label{tab:expandingbubble2Delements_adaptive}
\end{table*}
The observed errors for our numerical approximation are shown in
Table~\ref{tab:expandingbubble2Dp2p0adaptive},
\ref{tab:expandingbubble2Dp2p1dgadaptive} and
\ref{tab:expandingbubble2Dp2p1p0adaptive}.
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rllllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & EOC & $\HerrorUu2$ & $\LerrorPp$ & EOC
& CPU[s] \\
\hline
& \multicolumn{7}{c}{no remeshing} \\
\hline
 32 & 4.37607e-03 & 8.78021e-04 &    - & 1.81156e-02 & 5.74936e-01 &    - &
3 \\
 64 & 9.85447e-04 & 1.01294e-04 & 3.12 & 5.67749e-03 & 2.79462e-01 & 1.04 &
18 \\
128 & 2.42678e-04 & 2.92289e-05 & 1.79 & 2.75563e-03 & 1.48572e-01 & 0.91 &
221 \\
256 & 6.09781e-05 & 2.55111e-05 & 0.19 & 2.58915e-03 & 7.95637e-02 & 0.88 &
3652 \\
\hline
& \multicolumn{7}{c}{$C_a=60$\textdegree} \\
\hline
 32 & 3.91561e-03 & 7.10756e-04 &    - & 1.60401e-02 & 5.58280e-01 &    - &
18 \\
 64 & 1.00456e-03 & 3.71590e-04 & 0.94 & 1.11137e-02 & 2.94466e-01 & 0.92 &
113 \\
128 & 2.48565e-04 & 2.67810e-04 & 0.47 & 9.27231e-03 & 1.50823e-01 & 0.97 &
644 \\
256 & 6.04620e-05 & 7.00763e-05 & 1.89 & 3.87511e-03 & 6.32475e-02 & 1.23 &
3877 \\
\hline
& \multicolumn{7}{c}{$C_a=20$\textdegree} \\
\hline
 32 & 3.96937e-03 & 7.08593e-04 &    - & 1.55497e-02 & 5.62013e-01 &    - &
4 \\
 64 & 1.00880e-03 & 2.93799e-04 & 1.27 & 8.94937e-03 & 2.87566e-01 & 0.97 &
15 \\
128 & 2.43658e-04 & 1.44371e-04 & 1.03 & 5.72647e-03 & 1.53910e-01 & 0.90 &
154 \\
256 & 6.10778e-05 & 6.57476e-05 & 1.11 & 3.81816e-03 & 6.73295e-02 & 1.17 &
1441 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes expanding bubble adaptive mesh errors P2--P0]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Expanding bubble
problem on $(-1,1)^2\setminus[-\frac{1}{3},\frac{1}{3}]^2$ over the time
interval $[0,1]$ for the P2--P0 element with adaptive mesh.}
\label{tab:expandingbubble2Dp2p0adaptive}
\end{table*}
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rllllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & EOC & $\HerrorUu2$ & $\LerrorPp$ & EOC
& CPU[s] \\
\hline
& \multicolumn{7}{c}{no remeshing} \\
\hline
 32 & 4.44770e-03 & 1.03835e-03 &    - & 2.09015e-02 & 5.74058e-01 &    - &
2 \\
 64 & 9.96385e-04 & 1.24152e-04 & 3.06 & 5.85650e-03 & 2.79564e-01 & 1.04 &
22 \\
128 & 2.43860e-04 & 3.43865e-05 & 1.85 & 2.92915e-03 & 1.48563e-01 & 0.91 &
209 \\
256 & 6.09133e-05 & 2.85605e-05 & 0.26 & 2.71585e-03 & 7.95602e-02 & 0.88 &
4281 \\
\hline
& \multicolumn{7}{c}{$C_a=60$\textdegree} \\
\hline
 32 & 4.04836e-03 & 1.03041e-03 &    - & 2.11862e-02 & 5.58428e-01 &    - &
13 \\
 64 & 1.06336e-03 & 5.81260e-04 & 0.83 & 1.47843e-02 & 2.94451e-01 & 0.92 &
52 \\
128 & 2.64772e-04 & 4.48334e-04 & 0.37 & 1.27870e-02 & 1.50552e-01 & 0.97 &
364 \\
256 & 6.39800e-05 & 1.38724e-04 & 1.65 & 5.44161e-03 & 6.32714e-02 & 1.22 &
3743 \\
\hline
& \multicolumn{7}{c}{$C_a=20$\textdegree} \\
\hline
 32 & 4.08914e-03 & 9.75075e-04 &    - & 1.98793e-02 & 5.63360e-01 &    - &
5 \\
 64 & 1.05303e-03 & 4.43826e-04 & 1.14 & 1.14591e-02 & 2.87514e-01 & 0.97 &
13 \\
128 & 2.50894e-04 & 2.89007e-04 & 0.62 & 8.72470e-03 & 1.54031e-01 & 0.90 &
148 \\
256 & 6.40185e-05 & 1.15617e-04 & 1.29 & 5.10565e-03 & 6.98979e-02 & 1.11 &
2143 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes expanding bubble adaptive mesh errors P2--\pdg]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Expanding bubble
problem on $(-1,1)^2\setminus[-\frac{1}{3},\frac{1}{3}]^2$ over the time
interval $[0,1]$ for the P2--\pdg element with adaptive mesh.}
\label{tab:expandingbubble2Dp2p1dgadaptive}
\end{table*}
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rllllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & EOC & $\HerrorUu2$ & $\LerrorPp$ & EOC
& CPU[s] \\
\hline
& \multicolumn{7}{c}{no remeshing} \\
\hline
 32 & 4.39967e-03 & 1.14087e-03 &    - & 2.26396e-02 & 5.73270e-01 &    - &
6 \\
 64 & 9.94365e-04 & 1.34986e-04 & 3.08 & 6.01358e-03 & 2.79584e-01 & 1.04 &
25 \\
128 & 2.43769e-04 & 3.91547e-05 & 1.79 & 3.13728e-03 & 1.48565e-01 & 0.91 &
210 \\
256 & 6.08641e-05 & 3.20203e-05 & 0.28 & 2.77934e-03 & 7.95609e-02 & 0.88 &
3798 \\
\hline
& \multicolumn{7}{c}{$C_a=60$\textdegree} \\
\hline
 32 & 3.97673e-03 & 1.16740e-03 &    - & 2.54389e-02 & 5.59015e-01 &    - &
18 \\
 64 & 1.04465e-03 & 6.57166e-04 & 0.83 & 1.84165e-02 & 2.94657e-01 & 0.92 &
81 \\
128 & 2.64078e-04 & 5.07829e-04 & 0.37 & 1.60658e-02 & 1.50595e-01 & 0.97 &
385 \\
256 & 6.39339e-05 & 1.55008e-04 & 1.67 & 7.26636e-03 & 6.33057e-02 & 1.22 &
3274 \\
\hline
& \multicolumn{7}{c}{$C_a=20$\textdegree} \\
\hline
 32 & 4.02881e-03 & 1.12100e-03 &    - & 2.32002e-02 & 5.63527e-01 &    - &
4 \\
 64 & 1.04388e-03 & 5.00129e-04 & 1.16 & 1.39060e-02 & 2.85520e-01 & 0.98 &
18 \\
128 & 2.49831e-04 & 3.25755e-04 & 0.62 & 1.17532e-02 & 1.54026e-01 & 0.89 &
172 \\
256 & 6.45554e-05 & 1.34537e-04 & 1.25 & 6.48976e-03 & 6.98821e-02 & 1.11 &
2701 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes expanding bubble adaptive mesh errors P2--(P1+P0)]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Expanding bubble
problem on $(-1,1)^2\setminus[-\frac{1}{3},\frac{1}{3}]^2$ over the time
interval $[0,1]$ for the P2--(P1+P0) element with adaptive mesh.}
\label{tab:expandingbubble2Dp2p1p0adaptive}
\end{table*}
Comparing the error quantities in Tables~\ref{tab:expandingbubble2Dp2p0},
\ref{tab:expandingbubble2Dp2p1dg} and \ref{tab:expandingbubble2Dp2p1p0}
against the ones in Tables~\ref{tab:expandingbubble2Dp2p0adaptive},
\ref{tab:expandingbubble2Dp2p1dgadaptive} and
\ref{tab:expandingbubble2Dp2p1p0adaptive} we note that there appears to
be no advantage in using a highly refined mesh near the moving interface. Again
the element which performs better in term of errors is the P2--P0 element
which, together with the choice of $C_a=20$\textdegree, gives the best result
in terms of accuracy and performance.

The evolution of the discrete pressure solution in the case $J_\Gamma = 64$, for
the run with $C_a=60$\textdegree, can be seen in
Figure~\ref{fig:expanding_bubble_adaptive}.
\begin{figure}[htbp]
\centering
\subfloat[$t=0$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_adaptive_remesh_000.ps}}\\
\subfloat[$t=0.25$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_adaptive_remesh_025.ps}}
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_adaptive_remesh_050.ps}}\\
\subfloat[$t=0.75$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_adaptive_remesh_075.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/expanding_bubble_adaptive_remesh_100.ps}}
\caption[Stokes expanding bubble pressure adaptive mesh]
{($\mu_+ = 10\,\mu_- = \gamma = 1,\alpha = 0.15$) Pressure evolution of
the 2d expanding bubble for the P2--P0 element, adaptive mesh.}
\label{fig:expanding_bubble_adaptive}
\end{figure}

\subsection{Equidistribution property in 2d}
We now demonstrate the remarkable equidistribution property of our method
showing that the circular, equidistributed numerical steady state solution is
recovered by our method even if we choose a very nonuniform initial interface
$\Gamma^0$. This is the analogue of what shown in \S\ref{subsec:sd_circle}
for a pure geometric PDE. In particular, for the presented numerical
simulation, we take $\Gamma^0$ to be a very nonuniform approximation of a unit
circle, where we represent the upper half of the circle by a single vertex,
while the lower half resembles a semicircle. In total we use $J_\Gamma = 32$
elements for $\Gamma^0$ and we start with a very nonuniform bulk mesh with
$J_\Omega^0 = 670$ elements. Of course, the initial bulk mesh has to respect
the nonuniform approximation of the interface, and so is very nonuniform
itself. However, we see from the evolution in
Figure~\ref{fig:nonuniform_bubble_32_both} that as the interface gets closer
and closer to an equidistributed approximation of a circle, the bulk mesh also
becomes more uniform. For the presented simulation we used the physical
parameters $\mu= \gamma=1$. The uniform time step size is chosen as
$\tau=10^{-4}$ and we set $C_v=3$, recall (\ref{eq:volume_criterion}).
\begin{figure}[htbp]
\centering
\subfloat[$t=0$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_32_both_000.ps}}\\
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_32_both_050.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_32_both_100.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_32_both_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_32_both_500.ps}}
\caption[Stokes equidistribution property]
{($\mu=\gamma=1$) Mesh evolution of a nonuniform circle formed by
$J_\Gamma = 32$ elements. Here we use the P2--P0 element, and let $C_v = 3$.}
\label{fig:nonuniform_bubble_32_both}
\end{figure}
In Figure~\ref{fig:nonuniform_bubble_velocity_32_both} is shown the evolution of
$\|\vec U^m\|_{L^\infty(\Omega)}$ which, as expected, converges to zero.
\begin{figure}[htbp]
\centering
\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_velocity_32_both.ps}
\caption[Stokes equidistribution velocity]
{($\mu=\gamma=1$) $\|\vec U^m\|_{L^\infty(\Omega)}$ evolution for a nonuniform
circle formed by $J_\Gamma = 32$ elements. Here we use the P2--P0 element, and
let $C_v = 3$.}
\label{fig:nonuniform_bubble_velocity_32_both}
\end{figure}

Finally, we would also like to investigate the effect of using an adaptive bulk
mesh, which is more refined close to the interface, and performing only mesh
smoothing. We use $J_\Gamma = 64$ elements for $\Gamma^0$ and $J_\Omega^0 =
954$ elements for the bulk. We see from the evolution in
Figure~\ref{fig:nonuniform_bubble_64_adaptive} that, again, we obtain an
equidistributed approximation of a circle. Obviously, since we never perform a
remesh, the final bulk mesh quality is very poor.
\begin{figure}[htbp]
\centering
\subfloat[$t=0$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_64_coarse_smooth_000.ps}}\\
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_64_coarse_smooth_050.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_64_coarse_smooth_100.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_64_coarse_smooth_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_64_coarse_smooth_500.ps}}
\caption[Stokes equidistribution property adaptive mesh]
{($\mu=\gamma=1$) Mesh evolution of a nonuniform circle formed by
$J_\Gamma = 64$ elements and adaptive bulk mesh. Here we use the P2--P0
element, and no remeshing.}
\label{fig:nonuniform_bubble_64_adaptive}
\end{figure}
In Figure~\ref{fig:nonuniform_bubble_velocity_64_coarse_smooth} is shown the
evolution of $\|\vec U^m\|_{L^\infty(\Omega)}$ which, again, converges to zero.
\begin{figure}[htbp]
\centering
\includegraphics[width=.45\textwidth]
{figures/stokes/nonuniform_bubble_velocity_64_coarse_smooth.ps}
\caption[Stokes equidistribution velocity adaptive mesh]
{($\mu=\gamma=1$) $\|\vec U^m\|_{L^\infty(\Omega)}$ evolution for a nonuniform
circle formed by $J_\Gamma = 64$ elements and adaptive bulk mesh. Here we use
the P2--P0 element, and no remeshing.}
\label{fig:nonuniform_bubble_velocity_64_coarse_smooth}
\end{figure}
We notice that the evolution of the quantity $\|\vec U^m\|_{L^\infty(\Omega)}$
is now very smooth respect to the one reported in
Figure~\ref{fig:nonuniform_bubble_32_both} but this is not surprising since we
never perform a remesh.

\subsection{Energy decay and area conservation in 2d}
In Figure~\ref{fig:ellipse_both} we show the pressure evolution for a
simulation that starts with an initial ellipse, with major and minor axes of
1.6 and 0.75. We use the parameters $\mu = \gamma=1$, $\tau=10^{-2}$ and
$T=10$. The initial interface is discretized with $J_\Gamma = 40$ surface
elements while the initial bulk mesh is nearly uniform and it has $J_\Omega^0 =
1112$ elements. We employ the P2--P0 element and use the remeshing parameter
$C_v=3$ during the evolution. Figure~\ref{fig:ellipse_both_volumes} shows the
evolution of the relative inner area
$\frac{\mathcal{L}^2(\Omega^m_-)}{\mathcal{L}^2(\Omega^0_-)}$ and the
evolution of the interface energy $\gamma\,\mathcal{H}^{1}(\Gamma^m)$. The
graphs show that the inner area is nearly conserved, and that the interface
energy is monotonically decreasing. We point out that, since there is no exact
solution to the problem, we cannot show the pressure state at time $t=0$
therefore we show the pressure state at $t=10^{-5}$, which is computed with the
help of our scheme with one time step of size $\tau=10^{-5}$.
\begin{figure}[htbp]
\centering
\subfloat[$t=10^{-5}$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_both_000.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_both_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_both_500.ps}}\\
\subfloat[$t=7.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_both_750.ps}}
\subfloat[$t=10$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_both_1000.ps}}
\caption[Stokes ellipse pressure]
{($\mu=\gamma=1$) Pressure evolution of an ellipse that evolves towards a
circle. Here we use the P2--P0 element, and let $C_v = 3$.}
\label{fig:ellipse_both}
\end{figure}
\begin{figure}[htbp]
\centering
\subfloat[$\frac{\mathcal{L}^2(\Omega^m_-)}{\mathcal{L}^2(\Omega^0_-)}$]{
\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_both_bulk_inner_volume.ps}}
\subfloat[$\gamma\,\mathcal{H}^{1}(\Gamma^m)$]{
\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_both_interface_length.ps}}
\caption[Stokes ellipse inner area and interface energy]
{Evolutions of the relative inner area and the interface energy for
the simulation in Figure~\ref{fig:ellipse_both}.}
\label{fig:ellipse_both_volumes}
\end{figure}

As a comparison, we show in Figure~\ref{fig:ellipse_smooth} and
\ref{fig:ellipse_both_volumes_smooth} the same simulation when no remeshings are
performed, i.e. we use $C_v=\infty$ in (\ref{eq:volume_criterion}). We clearly
see that due to the strong deformation of the interface, this leads to
elongated elements in the inner and in the outer phase of the bulk finite
element mesh.
\begin{figure}[htbp]
\centering
\subfloat[$t=10^{-5}$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_smooth_000.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_smooth_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_smooth_500.ps}}\\
\subfloat[$t=7.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_smooth_750.ps}}
\subfloat[$t=10$]{\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_smooth_1000.ps}}
\caption[Stokes ellipse pressure no remeshing]
{($\mu=\gamma=1$) Pressure evolution of an ellipse that evolves towards a
circle. Here we use the P2--P0 element, and no remeshing.}
\label{fig:ellipse_smooth}
\end{figure}
\begin{figure}[htbp]
\centering
\subfloat[$\frac{\mathcal{L}^2(\Omega^m_-)}{\mathcal{L}^2(\Omega^0_-)}$]{
\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_smooth_bulk_inner_volume.ps}}
\subfloat[$\gamma\,\mathcal{H}^{1}(\Gamma^m)$]{
\includegraphics[width=.45\textwidth]
{figures/stokes/ellipse_smooth_interface_length.ps}}
\caption[Stokes ellipse inner area and interface energy no remeshing]
{Evolutions of the relative inner area and the interface energy for
the simulation in Figure~\ref{fig:ellipse_smooth}.}
\label{fig:ellipse_both_volumes_smooth}
\end{figure}

\subsection{Shear flow experiment in 2d}
As the final 2d numerical simulation we present a shear flow experiment. Here
we prescribe the inhomogeneous Dirichlet boundary condition
\begin{equation*}
\vec g(\vec z)=(z_2,0)^T\quad \mbox{on }\partial_1\Omega=\partial\Omega\,,
\end{equation*}
and we use the parameters $\mu=1$, $\gamma=3$, $\tau=10^{-2}$ and $T=5$.
The initial interface is discretized with $J_\Gamma = 64$ surface elements,
and the initial bulk mesh is nearly uniform with $J_\Omega^0 = 4240$ elements.
In Figure~\ref{fig:shear_2d} we show the evolution of the discrete pressures
for a simulation with $C_v=3$ for the P2--P0 element, while the velocities
are visualized in Figure~\ref{fig:shear_2d_velocity}.
\begin{figure}[htbp]
\centering
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_050.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_100.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_500.ps}}
\caption[Stokes 2d shear flow pressure]
{($\mu=1,\gamma=3$) Pressure evolution for the 2d shear flow with $C_v=3$ for
the P2--P0 element, nearly uniform mesh.}
\label{fig:shear_2d}
\end{figure}
\begin{figure}[htbp]
\centering
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_velocity_050.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_velocity_100.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_velocity_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_velocity_500.ps}}
\caption[Stokes 2d shear flow velocity]
{($\mu=1,\gamma=3$) Velocity vector field for the 2d shear flow with $C_v=3$
for the P2--P0 element, nearly uniform mesh.}
\label{fig:shear_2d_velocity}
\end{figure}

A plot of the relative inner area over time is shown in
Figure~\ref{fig:shear_2d_bulk_inner_volume}, where we again observe that our
numerical method maintains the enclosed volume well.
\begin{figure}[htbp]
\centering
\includegraphics[width=.45\textwidth]
{figures/stokes/2d_shear_bulk_inner_volume.ps}
\caption[Stokes 2d shear flow inner area]
{A plot of the relative inner area
$\frac{\mathcal{L}^2(\Omega^m_-)}{\mathcal{L}^2(\Omega^0_-)}$
over time for the simulation in Figure~\ref{fig:shear_2d}.}
\label{fig:shear_2d_bulk_inner_volume}
\end{figure}

Finally we want to compare the performance of different preconditioner
for the preconditioned GMRES used to solve the reduce system
(\ref{eq:SchurkX}) or, depending on the pressure space,
(\ref{eq:SchurkX_extended}). In Table~\ref{tab:shear_2d_preconditioners} we
report the CPU time, in seconds, and the number of GMRES iteration to solve the
algebraic system (\ref{eq:SchurkX_extended}) at the first time step, $m=0$. We
employ nearly uniform bulk meshes and the P2--(P1+P0) element. We test the
direct preconditioner (\ref{eq:stokes_direct_precond_extended}) factorizing it
alternatively with either UMFPACK or SPQR and the block preconditioner
(\ref{eq:ESW_extended}) with restart value either 50 or 1000.
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rrrrrrrrr}
\hline
$J_\Gamma$ & \multicolumn{2}{r}{Direct UMFPACK} &
\multicolumn{2}{r}{Direct SPQR} & \multicolumn{2}{r}{Block restart 50} &
\multicolumn{2}{r}{Block restart 1000} \\
\hline
 & CPU[s] & iterations & CPU[s] & iterations & CPU[s] & iterations & CPU[s] &
iterations \\
\hline
 16 &  0.06 & 6 &  0.13 & 5 &    0.94 &  349 &    1.16 &  221 \\
 32 &  0.33 & 7 &  0.68 & 6 &   11.33 &  839 &   11.51 &  441 \\
 64 &  1.83 & 8 &  4.16 & 8 &  138.58 & 2026 &  136.99 &  772 \\
128 & 10.05 & 9 & 25.71 & 9 & 2079.82 & 6436 & 1442.76 & 1745 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes 2d shear flow preconditioners comparison]
{($\mu=1,\gamma=3$) Time and number of GMRES iterations to solve the algebraic
system (\ref{eq:SchurkX_extended}) adopting different preconditioners for the 2d
shear flow using P2--(P1+P0) element, nearly uniform mesh and $m=0$.}
\label{tab:shear_2d_preconditioners}
\end{table*}
We can notice that the direct preconditioner, whose matrix is equivalent to
the standard Stokes discretization (\ref{eq:stokes_system}) perform extremely
well in terms of CPU time and number of GMRES iterations. This is not very
surprising since the preconditioner and the reduced two-phase stokes system
have almost the same matrix. Therefore the number of GMRES iterations is very
low. Moreover, the factorization is computed only once with both SPQR and
UMFPACK so it is extremely efficient to apply the preconditioner at every GMRES
iteration. On the other hand, the block preconditioner perform very poorly
requiring a very high number of GMRES iterations in order to converge. An
increase of the restart value obviously reduce the number of GMRES iterations
but also drastically increase the memory footprint. Moreover, the application
of the preconditioner consist of doing the backward substitution
(\ref{eq:blocksolution_extended}) which is expensive.

\subsection{Convergence test in 3d} \label{sec:stokes_3d_convergence_results}
Similarly to \S\ref{sec:stokes_2d_convergence_results}, we perform the following
convergence test for a stationary spherical bubble in 3d. Let $\mu = \gamma =
1$. Then the true solution (\ref{eq:radialr},b) reduces to $r(t) =
\frac{1}{2}$, $\vec u(\cdot, t) = \vec 0$ and $p(t) = 4\,\charfcn{\Omega_-(0)}
- \frac{\pi}{12}$ for all $t\geq0$. We approximate this stationary solution on
nearly uniform meshes that feature $J_\Gamma = 32$, $220$ and $596$ interface
elements, and $J_\Omega^0 = 408$, $3590$ and $20473$ bulk elements,
respectively. Here, in contrast to the situation in 2d, we are not able to
define $\Gamma^0$ such that the vertices of $\Gamma^0$ lie on $\Gamma(0)$ and
such that (\ref{eq:constcurv}) is satisfied. As we would like to demonstrate
the ability of our method to recover the discrete stationary solution
(\ref{eq:solsol}) also in 3d, we choose the initial interface $\Gamma^0$ such
that (\ref{eq:constcurv}) holds, at the expense of a nonzero initial error
$\| \Gamma^0 - \Gamma(0) \|_{L^\infty}$, recall (\ref{eq:errorXx}). We obtain
such an initial triangulation with the help of the numerical scheme
(\ref{eq:fem_surf_diff_a}--b)from Chapter~\ref{ch:geometric_pdes} for surface
diffusion, which is a gradient flow for surface area that maintains the
enclosed volume. See Figure~\ref{fig:conformal_sphere}, or
\cite[Fig. 11]{gflows3d}, for an evolution towards a polyhedral approximation
of a sphere that satisfies (\ref{eq:constcurv}), and hence also
(\ref{eq:conformal}). The sphere in Figure~\ref{fig:conformal_sphere} has
$J_\Gamma = 596$ elements.
\begin{figure}[htbp]
\centering
\subfloat[Initial sphere triangulation]
{\includegraphics[width=.45\textwidth]{figures/stokes/sphere_596.ps}}
\subfloat[Conformal polyhedral sphere triangulation]
{\includegraphics[width=.45\textwidth]{figures/stokes/sphere_stationary_596.ps}}
\caption[Conformal polyhedral sphere triangulation]{Initial triangulation of
a sphere and conformal polyhedral sphere after surface diffusion.}
\label{fig:conformal_sphere}
\end{figure}

We report on the errors for the P2--P0, P2--P1, P2--\pdg and P2--(P1+P0)
elements in Tables~\ref{tab:stokes_stationary_3d_p2p0},
\ref{tab:stokes_stationary_3d_p2p1}, \ref{tab:stokes_stationary_3d_p2p1dg} and
\ref{tab:stokes_stationary_3d_p2p1p0}, respectively. Here we note that, as yet,
for the pairs P2--P0, P2--\pdg and P2--(P1+P0) there exist no proofs in the
literature that the LBB condition (\ref{eq:LBB}) holds, see e.g. the discussion
in \cite[Remark~8.4.3]{BoffiBF13}. However, in practice we encountered no
problems when using these spaces, and our iterative solver always converged to a
solution of the scheme (\ref{eq:HGa}--d). For both sets of simulations we use
the uniform time step size $\tau = 10^{-2}$.
\begin{table*}
\center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 32 & 2.97986e-02 & 0 & 1.65555e-00 &    - &   385 \\
220 & 5.80971e-03 & 0 & 7.14269e-01 & 1.21 &  4699 \\
596 & 2.42857e-03 & 0 & 3.58466e-01 & 0.99 & 51604 \\
\hline
\end{tabular}
\caption[Stokes 3d stationary bubble errors P2--P0]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^3$ over the time
interval $[0,1]$ for the P2--P0 element.}
\label{tab:stokes_stationary_3d_p2p0}
\end{table*}
\begin{table*}
\center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 32 & 1.56938e-01 & 6.01956e-02 & 2.10996e-00 &    - &   315 \\
220 & 7.28946e-02 & 3.13992e-02 & 1.47595e-00 & 0.52 &  4231 \\
596 & 4.04291e-02 & 1.34276e-02 & 1.09674e-00 & 0.43 & 51287 \\
\hline
\end{tabular}
\caption[Stokes 3d stationary bubble errors P2--P1]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^3$ over the time
interval $[0,1]$ for the P2--P1 element.}
\label{tab:stokes_stationary_3d_p2p1}
\end{table*}
\begin{table*}
\center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 32 & 2.97986e-02 & 0 & 1.65555e-00 &    - &    73 \\
220 & 5.80971e-03 & 0 & 7.14269e-01 & 1.21 &  1018 \\
596 & 2.42857e-03 & 0 & 3.58466e-01 & 0.99 & 17814 \\
\hline
\end{tabular}
\caption[Stokes 3d stationary bubble errors P2--\pdg]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^3$ over the time
interval $[0,1]$ for the P2--\pdg element.}
\label{tab:stokes_stationary_3d_p2p1dg}
\end{table*}
\begin{table*}
\center
\begin{tabular}{rllllr}
\hline
$J_\Gamma$ & $\errorXx$ & $\LerrorUu2$ & $\LerrorPp$ & EOC & CPU[s] \\
\hline
 32 & 2.97986e-02 & 0 & 1.65749e-00 &    - &    568 \\
220 & 5.80971e-03 & 0 & 7.15353e-01 & 1.21 &   9174 \\
596 & 2.42857e-03 & 0 & 3.59181e-01 & 0.99 & 121110 \\
\hline
\end{tabular}
\caption[Stokes 3d stationary bubble errors P2--(P1+P0)]
{($\mu=\gamma=1$) Stationary bubble problem on $(-1,1)^3$ over the time
interval $[0,1]$ for the P2--(P1+P0) element.}
\label{tab:stokes_stationary_3d_p2p1p0}
\end{table*}

We note that we again recover the discrete stationary solutions
(\ref{eq:solsol}) for the P2--P0, P2--\pdg and P2--(P1+P0) elements while,
as before, the P2--P1 element does not capture exactly the true solution
since this element does not satisfy the hypothesis that
$\charfcn{\Omega^m_-}\in\pspace^m$ of Theorem~\ref{thm:stat2}. Here this leads
to a nonzero error in the position of the discrete interface, because the
vertices of the initial interface $\Gamma^0$ do not lie on $\Gamma(0)$.

\subsection{Shear flow experiment in 3d}
Finally, we also report on a 3d shear flow experiment. The initial interface
mesh has $J_\Gamma = 596$ elements, while the nearly uniform bulk mesh is made
up of $J_\Omega^0 = 19641$ elements. We prescribe the inhomogeneous Dirichlet
boundary condition
\begin{equation*}
\vec g(\vec z)=(z_3,0,0)^T\quad \mbox{on }\partial_1\Omega=\partial\Omega\,,
\end{equation*}
and we use the parameters $\mu=1$, $\gamma=3$, $\tau=10^{-2}$ and $T=5$.
In Figure~\ref{fig:shear_3d} we show the evolution of the discrete interface
for a simulation with $C_v=3$ for the P2--P0 element, while the velocities
are visualized in Figure~\ref{fig:shear_3d_velocity}.
\begin{figure}[htbp]
\centering
\subfloat[$t=0$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_000.ps}}\\
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_050.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_100.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_500.ps}}
\caption[Stokes 3d shear flow interface]
{($\mu=1,\gamma=3$) Interface evolution for the 3d shear flow with $C_v=3$ for
the P2--P0 element, nearly uniform mesh.}
\label{fig:shear_3d}
\end{figure}
\begin{figure}[htbp]
\centering
\subfloat[$t=0.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_velocity_050.ps}}
\subfloat[$t=1$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_velocity_100.ps}}\\
\subfloat[$t=2.5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_velocity_250.ps}}
\subfloat[$t=5$]{\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_velocity_500.ps}}
\caption[Stokes 3d shear flow velocity]
{($\mu=1,\gamma=3$) Velocity vector field in the plane normal to $(0,1,0)^T$
and passing through the origin for the 3d shear flow with $C_v=3$ for the
P2--P0 element, nearly uniform mesh.}
\label{fig:shear_3d_velocity}
\end{figure}

A plot of the relative inner volume over time is shown in
Figure~\ref{fig:shear_3d_bulk_inner_volume}, where we again observe that our
numerical method maintains the enclosed volume well.
\begin{figure}[htbp]
\centering
\includegraphics[width=.45\textwidth]
{figures/stokes/3d_shear_bulk_inner_volume.ps}
\caption[Stokes 3d shear flow inner volume]
{A plot of the relative inner volume
$\frac{\mathcal{L}^3(\Omega^m_-)}{\mathcal{L}^3(\Omega^0_-)}$
over time for the simulation in Figure~\ref{fig:shear_3d}.}
\label{fig:shear_3d_bulk_inner_volume}
\end{figure}

Finally, as in the 2d case, see Table~\ref{tab:shear_2d_preconditioners}, we
want to compare the performance of different preconditioners. In
Table~\ref{tab:shear_3d_preconditioners} we report the CPU time, in seconds,
and the number of GMRES iteration to solve the algebraic system
(\ref{eq:SchurkX_extended}) at the first time step, $m=0$. We employ adaptive
bulk meshes and the P2--(P1+P0) element. We test the direct preconditioner
(\ref{eq:stokes_direct_precond_extended}) factorizing it alternatively with
either UMFPACK or SPQR and the block preconditioner (\ref{eq:ESW_extended})
with restart value either 50 or 1000.
\begin{table*}
\center
\hspace*{-3.25cm}
\begin{tabular}{rrrrrrrrr}
\hline
$J_\Gamma$ & \multicolumn{2}{r}{Direct UMFPACK} &
\multicolumn{2}{r}{Direct SPQR} & \multicolumn{2}{r}{Block restart 50} &
\multicolumn{2}{r}{Block restart 1000} \\
\hline
 & CPU[s] & iterations & CPU[s] & iterations & CPU[s] & iterations & CPU[s] &
iterations \\
\hline
 32 &  0.16 & 8 &  0.26 & 5 &   1.10 & 158 &  1.17 & 130 \\
220 &  3.56 & 7 &  4.91 & 6 &  15.31 & 234 & 14.53 & 193 \\
596 & 13.77 & 6 & 44.44 & 6 & 101.53 & 328 & 93.00 & 266 \\
\hline
\end{tabular}
\hspace*{-3.25cm}
\caption[Stokes 3d shear flow preconditioners comparison]
{($\mu=1,\gamma=3$) Time and number of GMRES iterations to solve the algebraic
system (\ref{eq:SchurkX_extended}) adopting different preconditioners for the 3d
shear flow using P2--(P1+P0) element, adaptive mesh and $m=0$.}
\label{tab:shear_3d_preconditioners}
\end{table*}
We observe that also in 3d the direct preconditioners outperform the block
preconditioner both in term of GMRES iterations and CPU time.